(function(p,m){var b=(function(){var ai=function(){if(arguments.length==0){return}var ao=arguments;var ap=" "+String(arguments[0]);var an=1;ap=ap.replace(/([^\\])\{\}/g,function(ar,aq){var at=(ao.length-1)<an?"{}":String(ak(ao[an]));an++;return aq+at});ap=ap.replace(/\\\{\}/g,"{}");return ap.substring(1)};var ag=function(){var at=new Date();var aq=at.getFullYear();var ar="0"+String(at.getMonth()+1);ar=ar.substring(ar.length-2);var ao="0"+String(at.getDate());ao=ao.substring(ao.length-2);var an="0"+String(at.getHours());an=an.substring(an.length-2);var ap="0"+String(at.getMinutes());ap=ap.substring(ap.length-2);var au="0"+String(at.getSeconds());au=au.substring(au.length-2);return ar+ao+" "+an+":"+ap+":"+au};var ak=function(aq){if(null==aq){return null}if((typeof aq=="number")||(typeof aq=="string")||(typeof aq=="boolean")){return aq}else{if(typeof aq=="function"){return"function "+aq.name+"(){...}"}else{if(!(aq instanceof Array)&&(typeof aq=="object")){if(String(aq)!="[object Object]"){return String(aq)}else{try{var an={};for(var ap in aq){an[ap]=ak(aq[ap])}return JSON.stringify(an)}catch(ao){return String(aq)}}}else{if(aq instanceof Array){return JSON.stringify(aq.map(function(ar){return ak(ar)}))}else{return aq}}}}};var al=function(an){return ag()+" ["+an+"]: "};var af={};var am,ah;(function(){var an=true;am=function(){return an};ah=function(ao){an=ao}})();var ae=function(an){var ao=true;this.isEnabled=function(){return am()&&ao};this.setIsEnabled=function(ap){ao=ap;return this};this.getName=function(){return an};this.debug=function(){if(!this.isEnabled()){return}var ap=ai.apply(null,arguments);console.debug(al(an)+ap)};this.info=function(){if(!this.isEnabled()){return}var ap=ai.apply(null,arguments);console.info(al(an)+ap)};this.warn=function(){if(!this.isEnabled()){return}var ap=ai.apply(null,arguments);console.warn(al(an)+ap)};this.error=function(){if(!this.isEnabled()){return}var ap=ai.apply(null,arguments);console.error(al(an)+ap)};this.log=function(){if(!this.isEnabled()){return}var ap=ai.apply(null,arguments);console.log(al(an)+ap)}};var aj=function(ao){if(ao in af){return af[ao]}var an=new ae(ao);af[ao]=an;return an};ae.ofName=aj;ae.isGloballyEnabled=am;ae.setIsGloballyEnabled=ah;return ae})();var T=(function(){var ah="  __com.soft.plugin.touch#"+new Date().getTime()+"__  ";var af=function(ak,aj){ak=ak||{};aj=aj||{};for(var al in aj){if(!(al in ak)){ak[al]=aj[al]}}return ak};var ai=function(ak,aj){ak=ak||{};ak[aj]=ak[aj]||{};return ak[aj]};var ag=function(am,an,ak){if(!f){am.addEventListener?am.addEventListener("click",an):am.attachEvent("onclick",an);return}var al=ai(am,ah+".tap");al.callbacks=al.callbacks||[];if(al.callbacks.indexOf(an)!=-1){return}al.callbacks.push(an);ak=af(ak,{timespan:500,delta:{},useCapture:false});ak.delta=af(ak.delta,{x:10,y:15});var aj=ai(am,ah+".tap.meta");if(null==aj.touchstart){aj.touchstart=function(ao){var ap=ao.changedTouches?ao.changedTouches[0]:ao;al.startX=ap.screenX;al.startY=ap.screenY;al.startTimestamp=Date.now()};am.addEventListener("touchstart",aj.touchstart)}if(null==aj.touchend){aj.touchend=function(aq){var at=aq.changedTouches?aq.changedTouches[0]:aq;al.stopX=at.screenX;al.stopY=at.screenY;al.stopTimestamp=Date.now();var ar=al.stopTimestamp-al.startTimestamp,ap=Math.abs(al.stopX-al.startX),ao=Math.abs(al.stopY-al.startY);if(ar<=ak.timespan&&ap<=ak.delta.x&&ao<=ak.delta.y){al.callbacks.forEach(function(au){au&&au.call(am,aq)})}};am.addEventListener("touchend",aj.touchend,ak.useCapture)}};var ae=function(an,ao,aj){if(!f){an.removeEventListener?an.removeEventListener("click",ao):an.detachEvent("onclick",ao);return}if(!an.hasOwnProperty(ah)){return}var am=ai(an,ah+".tap");var al=am.callbacks.indexOf(ao);if(al==-1){return}am.callbacks.splice(al,1);if(am.callbacks.length==0){var ak=ai(an,ah+".tap.meta");an.removeEventListener("touchstart",ak.touchstart);an.removeEventListener("touchend",ak.touchend,aj);delete an[ah].tap}};return{addTapListener:ag,removeTapListener:ae}})();var z=function(af,ae,ah){if(arguments.length<3){ah=false}af=af||{};ae=ae||{};for(var ag in ae){if(!(ag in af)||(ag in af&&null==af[ag]&&ah)){af[ag]=ae[ag]}}return af};var L=(function(){var ae=function(af,ag){this.type=af;this.timestamp=new Date().getTime();this.data=ag;Object.freeze&&Object.freeze(this)};return function(ah,af){var ag={};var ai=function(aj){ag[aj]=ag[aj]||[]};ah.on=function(ak,aj){ak=ak.toLowerCase();ai(ak);if(ag[ak].indexOf(aj)!=-1){return}ag[ak].push(aj)};ah.off=function(al,ak){al=al.toLowerCase();ai(al);var aj=ag[al].indexOf(ak);if(aj==-1){return}ag[al].splice(aj,1)};ah.fire=function(aj,al){aj=aj.toLowerCase();var ak=new ae(aj,al);ai(aj);ag[aj].forEach(function(am){am.call(af,ak)})}}})();var r=function(af,ae,ag){Object.defineProperty(af,ae,{value:ag,configurable:false,writable:false,enumerable:true})};var F=function(ag,ae,af){if(null==ag||typeof ag!="function"){return}try{ag.apply(ae,af)}catch(ah){o.error("Error occured while executing function: {}. {}",ag.name,ah)}};var i=function(af,ae){if(arguments.length<2){ae=false
}if(null===af||undefined===af){return true}af=String(af);if(ae){af=af.trim()}return af.length==0};var a=function(ae){return null===ae||undefined===ae};var N=function(ah,af,ag,ae){if(arguments.length<4){ae=true}if(arguments.length<3){ag=true}if(a(ah)){if(a(af)){return true}return false}else{if(a(af)){return false}if(ae){ah=String(ah).trim();af=String(af).trim()}if(!ag){ah=ah.toLowerCase();af=af.toLowerCase()}return ah===af}};var A=function(ag,af,ae){if(arguments.length<3){ae=true}return N(ag,af,false,ae)};var h=/mobile|tablet|ip(ad|hone|od)|android/i,Q=("ontouchstart" in window),f=h.test(navigator.userAgent);var c=new Object();var v=":back",P=":forward";var x=document.documentElement;var o=b.ofName("View");var aa=[];var W=null;var I="data-view",e="data-view-default",q="data-view-directly-accessible",ab="data-view-fallback",X="data-view-rel",V="data-view-rel-disabled",S="data-view-rel-type",u="data-view-title";var ad=("pushState" in history)&&(typeof history.pushState=="function");o.log("History pushState is "+(ad?"":"not ")+"supported");var R=[];var k={};var M=function(ae){return v==ae||P==ae};var C=function(ae,af,ag){if(!Z.ifExists(ae)&&!M(ae)){throw new Error("View of id: "+ae+" does not exist.")}if(arguments.length<3){throw new Error("Invalid argument length. Both parameter name and value should be specified.")}k[ae]=k[ae]||{};k[ae][String(af)]=ag;return Z};var y=function(ae,af){if(!Z.ifExists(ae)&&!M(ae)){throw new Error("View of id: "+ae+" does not exist.")}if(undefined===af){af=null}if(typeof af!="object"){throw new Error("Parameters specified should be an object or null.")}k[ae]=af;return Z};var Y=function(ae){delete k[ae];return Z};var l=function(ae,ag,af){if(arguments.length<3){af=null}if(arguments.length<2){ag=Date.now()}r(this,"viewId",ae);r(this,"timestamp",ag);r(this,"options",af);this.toString=function(){return JSON.stringify(this)};this.clone=function(){return JSON.parse(this.toString())}};l.isConstructorOf=function(ae){if(null==ae||typeof ae!="object"){return false}return ae.hasOwnProperty("viewId")&&ae.hasOwnProperty("timestamp")};var ac=function(ae){return encodeURIComponent(String(ae)).replace(/\+/gm,"%2B")};var O=function(af,ah){var ag="!";var aj=String(af);var ae=null==ah?[]:Object.keys(ah);var ai=ae.reduce(function(an,am,al,ak){return an+"&"+ac(am)+"="+ac(ah[am])},"");if(ai.length>0){aj+=ag+ai.substring(1)}return aj};var E=function(ae,ah,af){if(arguments.length<3){af=null}if(arguments.length<2){ah=Date.now()}var ag=new l(ae,ah,af).clone();o.log("â†“ {}",JSON.stringify(ag));if(ad){history.pushState(ag,"","#"+O(ae,af))}else{location.hash=O(ae,af)}Z.currentState=ag};var t=function(ae,ah,af){if(arguments.length<3){af=null}if(arguments.length<2){ah=Date.now()}var ag=new l(ae,ah,af).clone();o.log("% {}",JSON.stringify(ag));if(ad){history.replaceState(ag,"","#"+O(ae,af))}else{location.hash=O(ae,af)}Z.currentState=ag};var H=function H(ae){var ag=ae,ah=c,af;this.getName=function(){return ag};this.getValue=function(ai){if(c==ah){if(arguments.length<1){return undefined}return ai}else{return ah}};this.setValue=function(ai){ah=ai;return this};this.getApplication=function(){return af};this.setApplication=function(ai){af=ai;return this};this.apply=function(){if(typeof af=="function"){af(ah)}return this};Object.freeze(this)};var w=function w(){var ae={};this.has=function(af){return af in ae};this.get=function(af){var ag;if(af in ae){ag=ae[af]}else{ag=new H(af);ae[af]=ag}return ag};this.applyAll=function(){var af=Object.keys(ae).map(function(ag){return ae[ag]});if(0!=af.length){setTimeout(function(){af.forEach(function(ah){try{ah.apply()}catch(ag){console.error(ag)}})},0)}};this.listAll=function(){return Object.keys(ae)}};var B=function B(){var ae={};r(this,"has",function(af){return af in ae});r(this,"set",function(af,ag){ae[af]=ag;return this});r(this,"get",function(af){return ae[af]});r(this,"clear",function(){ae={};return this})};var Z=function(ai){if(null===document.querySelector("#"+ai+"["+I+"=true]")){throw new Error("View of id: "+ai+" does not exist(No element matching pattern: '#"+ai+"["+I+"=true]' found)!")}var ag={};var ae=new B();var ah=new w();L(this,document.querySelector("#"+ai));var af=this.fire;this.fire=function(aj,ak){ag[aj]=ak;af(aj,ak)};r(this,"logger",b.ofName("View#"+ai));r(this,"config",ah);r(this,"context",ae);this.getLatestEventData=function(aj){return ag[aj]};this.getContext=function(){return ae};this.clearContext=function(){ae.clear();return this};this.getId=function(){return ai};this.getDomElement=function(){return document.querySelector("#"+ai)};this.find=function(aj){return this.getDomElement().querySelector(aj)};this.findAll=function(aj){return this.getDomElement().querySelectorAll(aj)};this.getParameter=function(aj){var ak=k[this.getId()];if(arguments.length<1){return ak}return null==ak?null:ak[aj]};this.isReady=function(){return R.indexOf(this.getId())!=-1};this.isActive=function(){return this.getDomElement().classList.contains("active")};this.isDefault=function(){return/true/i.test(this.getDomElement().getAttribute(e))
};this.isDirectlyAccessible=function(){var aj=this.getDomElement().getAttribute(q);aj=null==aj?null:aj.toLowerCase();if(Z.isDirectlyAccessible()){return"false"==aj?false:true}else{return"true"==aj?true:false}};this.getFallbackView=function(){var aj=this;var al=[this.getId()];do{var ak=aj.getDomElement().getAttribute(ab);if(null==ak||!Z.ifExists(ak)){o.warn("View: "+aj.getId()+" is not permited to access directly, and no fallback configuration found, thus returning the default view");return Z.getDefaultView()}else{aj=Z.ofId(ak);if(al.indexOf(aj.getId())!=-1){o.error("Cyclical reference of view on fallback configuration on view: {}. Chain: {}, view id: {}",this.getId(),al,aj.getId());return Z.getDefaultView()}if(aj.isDirectlyAccessible()){return aj}al.push(ak)}}while(true)};Object.freeze&&Object.freeze(this)};Z.SWITCHTYPE_HISTORYFORWARD="history.forward";Z.SWITCHTYPE_HISTORYBACK="history.back";Z.SWITCHTYPE_VIEWSWITCH="view.switch";Z.Logger=b;Z.currentState=null;L(Z);Z.ofId=function(ag){for(var af=0;af<aa.length;af++){if(aa[af].getId().trim()==ag.trim()){return aa[af]}}var ae=new Z(ag);aa.push(ae);return ae};Z.ifExists=function(af){for(var ae=0;ae<aa.length;ae++){if(aa[ae].getId().trim()==af.trim()){return true}}return false};Z.isExisting=Z.ifExists;Z.listAll=function(){return[].concat(aa)};Z.setAsDefault=function(ae){var ag=Z.getDefaultView();if(null!=ag){if(ag.getId()==ae){return}ag.getDomElement().removeAttribute(e)}var af=Z.ofId(ae);var ah=af.getDomElement();ah.setAttribute(e,"true");return Z};Z.isDirectlyAccessible=function(){var ae=x.getAttribute(q);return A("true",ae)};Z.setIsDirectlyAccessible=function(ae){x.setAttribute(q,String(!!ae).toLowerCase());return Z};Z.getActiveView=function(){for(var ae=0;ae<aa.length;ae++){if(aa[ae].isActive()){return aa[ae]}}return null};Z.getDefaultView=function(){for(var ae=0;ae<aa.length;ae++){if(aa[ae].isDefault()){return aa[ae]}}return null};Z.setSwitchAnimation=function(ae){if(!(ae instanceof Function)){throw new Error("Invalid argument. Animation of Function is needed.")}W=ae;return Z};Z.getSwitchAnimation=function(){return W};var n=function(aj){if(""==aj){return null}var ai=/^#([\w\$\-]+)(?:!+(.*))?/;var af=aj.match(ai);if(null==af){return null}var ae=af[1],ah=null;if(null!=af[2]&&""!=af[2].trim()){var ag=af[2].split(/\s*&\s*/);if(0!=ag.length){ah={};ag.forEach(function(al){var ak=al.split(/\s*=\s*/);ah[decodeURIComponent(ak[0])]=decodeURIComponent(ak[1])})}}return{viewId:af[1],options:ah}};Z.getActiveViewOptions=function(){var ae=n(location.hash);return null==ae?null:ae.options};var D=function(ag){ag=z(ag,{srcView:null,targetView:null,type:Z.SWITCHTYPE_VIEWSWITCH,withAnimation:true,params:null});var am=ag.srcView,ae=ag.targetView,ak=ag.type,ah=ag.params;if(null==ak){ak=Z.SWITCHTYPE_VIEWSWITCH}var an=A(ak,Z.SWITCHTYPE_HISTORYBACK),al=A(ak,Z.SWITCHTYPE_HISTORYFORWARD);if(!an&&!al){ak=Z.SWITCHTYPE_VIEWSWITCH}Z.fire("beforechange",{currentView:am,targetView:ae,type:ak,params:ah});am&&am.fire("leave",{targetView:ae,type:ak});var aj=function(){am&&am.getDomElement().classList.remove("active");ae.getDomElement().classList.add("active")};var ai=function(){var ao=ae.getId();Y(ao);if(an){if(v in k){y(ao,k[v]);delete k[v]}}else{if(al){if(P in k){y(ao,k[P]);delete k[P]}}else{y(ao,ah)}}var ap={sourceView:am,type:ak,params:ah};if(!ae.isReady()){R.push(ao);ae.fire("ready",ap)}["beforeenter","enter","afterenter"].forEach(function(aq){ae.fire(aq,ap)})};var af=function(){aj();ai()};if(!ag.withAnimation){af()}else{if(W){W.call(null,am?am.getDomElement():null,ae.getDomElement(),ak,af)}else{af()}}Z.fire("afterchange",{currentView:am,targetView:ae,type:ak,params:ah})};var G=function(ae,ag){ag=z(ag,{type:Z.SWITCHTYPE_VIEWSWITCH},true);if(!Z.ifExists(ae)){throw new Error("Target view: "+ae+" does not exist!")}var ah=Z.getActiveView();if(A(ah.getId(),ae)){return Z}o.log("{} â†’ {} {}",ah.getId(),ae,JSON.stringify(ag));var af=Z.ofId(ae);ag.srcView=ah;ag.targetView=af;D(ag);return Z};Z.show=G;Z.switchTo=function(ae,ag,af,ah){if(arguments.length<4){ah=null}if(arguments.length<3){af=true}if(arguments.length<2){ag=Z.SWITCHTYPE_VIEWSWITCH}ag=ag||Z.SWITCHTYPE_VIEWSWITCH;G(ae,{type:ag,withAnimation:af,params:ah});return Z};Z.switchView=Z.switchTo;Z.navTo=function(ae,af){ae=ae.trim();var ag=Z.getActiveView();if(A(ag.getId(),ae)){return Z}if(v==ae){Z.back(af);return Z}if(P==ae){Z.forward(af);return Z}G(ae,af);E(ae,Date.now(),af.options);return Z};Z.updateView=Z.navTo;Z.changeTo=function(ae,af){var ag=Z.getActiveView();if(A(ag.getId(),ae)){return Z}G(ae,af);t(ae,Date.now(),af.options);return Z};Z.back=function(ae){Y(v);if(null!=ae&&"params" in ae){y(v,ae.params)}history.go(-1)};Z.forward=function(ae){Y(P);if(null!=ae&&"params" in ae){y(P,ae.params)}history.go(1)};var j=document.title;var K=function(ae){if(i(ae,true)){o.warn("Invalid document title: "+ae);return Z}document.title=j=ae;return Z};Z.setDocumentTitle=K;var d;Z.ready=(function(){var af=false;var ae=[];d=function(){af=true;setTimeout(function(){ae.forEach(function(ag){F(ag)
});ae=[]},0)};return function(ag){if(af){F(ag);return Z}if(ae.indexOf(ag)!=-1){return Z}ae.push(ag);return Z}})();var g=function(){var ae=Z.getActiveView();if(null==ae){ae=Z.getDefaultView()}return ae};var s=function(ae){var af=null;if(i(ae,true)||!Z.ifExists(ae)){af=g()}else{af=Z.ofId(ae);if(!af.isDirectlyAccessible()){af=af.getFallbackView()}}return af};var J=function(aj){var al=Z.getActiveView();var ag=null==al?null:al.getId();o.log("{} Current: {}",ad?"State poped!":"Hash changed!",al.getId());o.log("â†‘ {}",ad?JSON.stringify(aj.state):location.hash);var an,ak=Z.SWITCHTYPE_VIEWSWITCH,ap,ae=null;if(null==aj.state){ak=Z.SWITCHTYPE_VIEWSWITCH;var am=n(location.hash);an=am.viewId;ae=s(an);var ai=ae.getId();var af=ai==an,ao=ai==ag;ap=ao?Z.currentState.options:(af?am.options:null);t(ai,Date.now(),ap)}else{var ah=aj.state;an=ah.viewId;if(Z.ifExists(an)){ae=Z.ofId(an);ap=ah.options}else{o.warn("Poped view: "+an+" does not exist, keeping current.");ae=al;ap=null}var ai=ae.getId();if(Z.currentState!=null){ak=ah.timestamp<Z.currentState.timestamp?Z.SWITCHTYPE_HISTORYBACK:Z.SWITCHTYPE_HISTORYFORWARD}t(ai,ah.timestamp,ap)}Z.show(ae.getId(),{type:ak,options:ap})};var U=function(){window.addEventListener(ad?"popstate":"hashchange",J);var af=document.querySelectorAll("*["+I+"=true]");[].forEach.call(af,function(ah){Z.ofId(ah.id);ah.classList.remove("active");ah.classList.add("view");(function(){var aj=ah.getAttribute(u);var ai=Z.ofId(ah.id);ai.on("enter",function(){document.title=null==aj?j:aj})})()});var ag=null;var ae=function(){var aj=null;var ai=-1;for(var ah=0;ah<af.length;ah++){if("true"==af[ah].getAttribute(e)){ai=ah;break}}if(-1!=ai){aj=af[ai];for(var ah=ai+1;ah<af.length;ah++){if("true"==af[ah].getAttribute(e)){af[ah].removeAttribute(e)}}}else{if(0!=af.length){aj=af[0];aj.setAttribute(e,"true")}else{o.warn("No view exists to determine the default view.")}}return aj};ag=ae();if(null!=ag){ag.classList.add("active")}(function(){var am=null==ag?null:ag.id;var ak=n(location.hash);var al=null==ak?null:ak.viewId,aj=null==ak?null:ak.options;var ah=i(al,true)?am:al;if(i(ah,true)){o.warn("Can not determine the initial view!");return}var ai=s(ah);ah=ai.getId();if(ah!=al){aj=null}t(ah,Date.now(),aj);D({srcView:Z.getActiveView(),targetView:ai,withAnimation:false,params:null})})();(function(){T.addTapListener(x,function(an){var am=an.changedTouches?an.changedTouches[0].target:an.target;var ah;var al=am;while(null==al.getAttribute(X)){al=al.parentNode;if(!(al instanceof HTMLElement)){al=null}if(null==al){break}}if(null!=al){ah=al.getAttribute(X)}if(null==ah){return}var ao="true"==al.getAttribute(V);if(ao){return}an.preventDefault();if(/^(http|https|ftp):\/\//gim.test(ah)){window.location.href=ah;return}if(A(v,ah)){history.go(-1);return}if(A(P,ah)){history.go(1);return}var ak=Z.getActiveView();var ai=null==ak?null:ak.getId();if(null!=ai&&ai==ah){return}var aj=al.getAttribute(S);aj=i(aj,true)?"nav":aj;if(!/^(?:nav)|(?:change)$/.test(aj)){o.warn("Unknown view switch type: {}. {}",aj,al);aj="nav"}Z[aj+"To"](ah,{type:Z.SWITCHTYPE_VIEWSWITCH})},{useCapture:true})})();d()};document.addEventListener("DOMContentLoaded",U);p[m]=Z})(window,"View");