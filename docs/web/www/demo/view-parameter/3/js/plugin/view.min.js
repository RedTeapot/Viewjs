/**
 * View.js v1.6.1-B201907092232
 * author: Billy, wmjhappy_ok@126.com
 * license: MIT
 */
!function(e,t){t in e?console.error("Plugin name: 'View' has already been used."):e[t]={}}(window,"View"),function(e){function s(e,t){this.type=e,this.timestamp=(new Date).getTime(),this.data=t,Object.freeze&&Object.freeze(this)}e.View.eventDrive=function(e,a){function o(e){u[e]=u[e]||[]}var u={};e.on=function(e,t){String(e).replace(/(\s*,){2,}/,",").toLowerCase().split(/\s*,\s*/).forEach(function(e){o(e),-1===u[e].indexOf(t)&&u[e].push(t)})},e.off=function(e,n){String(e).replace(/(\s*,){2,}/,",").toLowerCase().split(/\s*,\s*/).forEach(function(e){o(e);var t=u[e].indexOf(n);-1!==t&&u[e].splice(t,1)})},e.fire=function(e,t,r){arguments.length<3&&(r=!0),String(e).replace(/(\s*,){2,}/,",").toLowerCase().split(/\s*,\s*/).forEach(function(n){function e(){o(n);for(var e=0;e<u[n].length;e++){var t=u[n][e];if("function"==typeof t)try{t.call(a,i)}catch(e){console.error(e,e.stack)}}}var i=new s(n,t);r?setTimeout(e,0):e()})}}}(window),function(e){var t=function(){function i(){if(0!=arguments.length){var i=arguments,e=" "+String(arguments[0]),r=1;return(e=(e=e.replace(/([^\\])\{\}/g,function(e,t){var n=i.length-1<r?"{}":String(a(i[r]));return r++,t+n})).replace(/\\\{\}/g,"{}")).substring(1)}}function r(e){return function(){var e=new Date,t=(e.getFullYear(),"0"+String(e.getMonth()+1));t=t.substring(t.length-2);var n="0"+String(e.getDate());n=n.substring(n.length-2);var i="0"+String(e.getHours());i=i.substring(i.length-2);var r="0"+String(e.getMinutes());r=r.substring(r.length-2);var a="0"+String(e.getSeconds());return t+n+" "+i+":"+r+":"+(a=a.substring(a.length-2))}()+" ["+e+"]: "}var e,t,n,a=function(e){if(null==e)return null;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e)return e;if("function"==typeof e)return"function "+e.name+"(){...}";if("object"!=typeof e||Array.isArray(e))return e instanceof Array?"["+e.map(function(e){return a(e)}).join(", ")+"]":e;if("[object Object]"!=String(e))return String(e);var t=JSON.stringify(e);if("{}"!=t)return t;try{var n={};for(var i in e)n[i]=a(e[i]);return JSON.stringify(n)}catch(e){return t}},o={};n=!0,e=function(){return n},t=function(e){n=e};function u(t){var n=!0;this.isEnabled=function(){return e()&&n},this.setIsEnabled=function(e){return n=e,this},this.getName=function(){return t},this.debug=function(){if(this.isEnabled()){var e=i.apply(null,arguments);console.debug(r(t)+e)}},this.info=function(){if(this.isEnabled()){var e=i.apply(null,arguments);console.info(r(t)+e)}},this.warn=function(){if(this.isEnabled()){var e=i.apply(null,arguments);console.warn(r(t)+e)}},this.error=function(){if(this.isEnabled()){var e=i.apply(null,arguments);console.error(r(t)+e)}},this.log=function(){if(this.isEnabled()){var e=i.apply(null,arguments);console.log(r(t)+e)}}}return u.ofName=function(e){if(e in o)return o[e];var t=new u(e);return o[e]=t},u.isGloballyEnabled=e,u.setIsGloballyEnabled=t,u}();t.globalLogger=t.ofName("View"),e.View.Logger=t}(window),function(ctx,name){var globalLogger=ctx[name].Logger.globalLogger,setDftValue=function(e,t,n){for(var i in arguments.length<3&&(n=!1),e=e||{},t=t||{})i in e&&!(i in e&&null==e[i]&&n)||(e[i]=t[i]);return e},defineReadOnlyProperty=function(e,t,n){Object.defineProperty(e,t,{value:n,configurable:!1,writable:!1,enumerable:!0})},try2Apply=function(t,e,n){if(null!=t&&"function"==typeof t)try{t.apply(e,n)}catch(e){var i=e instanceof Error||null!=e&&"object"==typeof e&&"stack"in e,r="Error occured while executing function: {}. {}"+(i?" stack:\n{}":"");globalLogger.error(r,t.name,e,i?e.stack:null)}},try2Call=function(func,ctx,args){if(null!=func&&"function"==typeof func)try{var len=arguments.length;if(1===len)return func();if(2===len)return func.call(ctx);if(3===len)return func.call(ctx,args);if(4===len)return func.call(ctx,args,arguments[3]);if(5===len)return func.call(ctx,args,arguments[3],arguments[4]);if(6===len)return func.call(ctx,args,arguments[3],arguments[4],arguments[5]);if(7===len)return func.call(ctx,args,arguments[3],arguments[4],arguments[5],arguments[6]);for(var tmp="",index=2,i=index,rst;i<arguments.length;i++)tmp+=",arguments["+i+"]";return eval("rst = func.call(ctx"+tmp+")"),rst}catch(e){return void console.error("Error occured while executing function: "+func.name,e,e.stack)}},isEmptyString=function(e,t){return arguments.length<2&&(t=!1),null==e||(e=String(e),t&&(e=e.trim()),0===e.length)},isNullOrUndefined=function(e){return null==e},ifStringEquals=function(e,t,n,i){return arguments.length<4&&(i=!0),arguments.length<3&&(n=!0),isNullOrUndefined(e)?!!isNullOrUndefined(t):!isNullOrUndefined(t)&&(i&&(e=String(e).trim(),t=String(t).trim()),n||(e=e.toLowerCase(),t=t.toLowerCase()),e===t)},ifStringEqualsIgnoreCase=function(e,t,n){return arguments.length<3&&(n=!0),ifStringEquals(e,t,!1,n)},randomString=(Va="0123456789abcdefghijklmnopqrstuvwxyz",function(e){arguments.length<1&&(e="");for(var t=10,n="";0<t--;){var i=Math.floor(Math.random()*Va.length);n+=Va.charAt(i)}return e+n}),Va,xEncodeURIComponent=function(e){return encodeURIComponent(String(e)).replace(/\+/gm,"%2B")},getUniqueString=(_a=0,function(){var e=Date.now().toString(36),t="00"+(_a++).toString(36);return(e+(t=t.substring(t.length-2))).toUpperCase()}),_a,getComputedStyle=function(e){return window.getComputedStyle?window.getComputedStyle(e):e.currentStyle},env=(eb=navigator.userAgent,fb=/(?:MQQBrowser|QQ)/.test(eb),gb=/(?:UCWEB|UCBrowser)/.test(eb),hb=/(?:Safari)/.test(eb),ib=/(?:Opera Mini)/.test(eb),jb=/(?:Mac OS)/.test(eb),kb=/(?:Android)/.test(eb),lb=/(?:Windows Phone)/.test(eb),mb=jb&&/(?:iPad)/.test(eb),nb=jb&&/(?:iPhone)/.test(eb),ob=/(?:Tablet|PlayBook)/.test(eb)||mb,pb=/(?:Mobile)/.test(eb)&&!mb||lb,qb=!pb&&!ob,rb={},(rb.refresh=tb)(),rb),eb,fb,gb,hb,ib,jb,kb,lb,mb,nb,ob,pb,qb,rb;function tb(){return eb=navigator.userAgent,fb=/(?:MQQBrowser|QQ)/.test(eb),gb=/(?:UCWEB|UCBrowser)/.test(eb),hb=/(?:Safari)/.test(eb),ib=/(?:Opera Mini)/.test(eb),jb=/(?:Mac OS)/.test(eb),kb=/(?:Android)/.test(eb),lb=/(?:Windows Phone)/.test(eb),mb=jb&&/(?:iPad)/.test(eb),nb=jb&&/(?:iPhone)/.test(eb),ob=/(?:Tablet|PlayBook)/.test(eb)||mb,pb=/(?:Mobile)/.test(eb)&&!mb||lb,qb=!pb&&!ob,rb.isQB=fb,rb.isUC=gb,rb.isSafari=hb,rb.isOpera=ib,rb.isIOS=jb,rb.isAndroid=kb,rb.isWindowsPhone=lb,rb.isIPad=mb,rb.isIPhone=nb,rb.isTablet=ob,rb.isMobile=pb,rb.isPc=qb,rb.isHistoryPushPopSupported="pushState"in history&&"function"==typeof history.pushState,rb}var parseParams=function(e){if(isEmptyString(e,!0))return null;var n=null,t=e.split(/\s*&\s*/);return 0!==t.length&&(n={},t.forEach(function(e){var t=e.split(/\s*=\s*/);n[decodeURIComponent(t[0])]=decodeURIComponent(t[1])})),n};ctx[name].util={setDftValue:setDftValue,defineReadOnlyProperty:defineReadOnlyProperty,try2Apply:try2Apply,try2Call:try2Call,isEmptyString:isEmptyString,isNullOrUndefined:isNullOrUndefined,ifStringEquals:ifStringEquals,ifStringEqualsIgnoreCase:ifStringEqualsIgnoreCase,randomString:randomString,xEncodeURIComponent:xEncodeURIComponent,getUniqueString:getUniqueString,getComputedStyle:getComputedStyle,parseParams:parseParams,env:env}}(window,"View"),function(e,t){var b=e[t].util,S=e[t].Logger.globalLogger,n=function(){function t(){var e=document.documentElement;return e.clientWidth<=e.clientHeight}var e,n,i,r,a=[],o=function(t){clearTimeout(e),e=setTimeout(function(){for(var e=0;e<a.length;e++)b.try2Call(a[e],null,t)},20)},u=(n=!1,i=-1,r=t(),s(),function(e){n?Date.now()-i<500?l(e):s():(n=!0,i=Date.now(),l(e))});function s(){n=!1,i=-1}function l(e){r==t()?setTimeout(u,20):(s(),r=t(),o(e))}var c,f,g,d,w,h=(g=f=0,v.reset=function(){g=f=0},v.try2ExecChangeCallbacks=p,v);function p(){clearTimeout(c),c=setTimeout(o,20)}function v(){var e=window.innerWidth,t=window.innerHeight,n=Math.abs(e-f);(0==f||n<.01&&g<t)&&(f=e,g=t,p()),f=e,g=t}function m(){h.reset(),clearInterval(d),d=null}(w=null,function(){setInterval(function(){b.env.refresh(),w=b.env.isPc?("pc"!=w&&(S.debug("Page viewing mode is PC mode."),m(),window.removeEventListener("orientationchange",u),o(),window.addEventListener("resize",o)),"pc"):("!pc"!=w&&(S.debug("Page viewing mode is none-PC mode."),window.removeEventListener("resize",o),o(),window.addEventListener("orientationchange",u),m(),d=setInterval(h,50)),"!pc")},30)})();var y={isPortrait:t,isLandscape:function(){var e=document.documentElement;return e.clientWidth>e.clientHeight},addChangeListener:function(e){-1==a.indexOf(e)&&a.push(e)}};return Object.freeze&&Object.freeze(y),y}();e[t].resolution=n}(window,"View"),function(e,t){var o,u,s,l,n,c,i,f,g,d,w,h,p,v,r,a=e[t].Logger.globalLogger,m=e[t].util,y=e[t].resolution,b=(s=320/568,n=!(l=[]),c={},i=document.documentElement,h=d=g=f=function(e,t){var n=this.style;n.width=e+"px",n.height=t+"px"},v=p=w=g,o=V(),u=E(),r=function(e){arguments.length<1&&(e=!0),m.env.isPc?function(){var e=I(),t=A();C()?m.try2Call(h,S(),e,t):v===p?(e=t*s,m.try2Call(f,S(),e,t)):m.try2Call(v,S(),e,t)}():m.env.isTablet?function(){var e=I(),t=A(),n=O()?w:d;m.try2Call(n,S(),e,t)}():function(){var e=I(),t=A(),n=O()?g:f;m.try2Call(n,S(),e,t)}();var n=V(),i=E(),r=I(),a=A();if(.1<=Math.abs(o-n)||.1<=Math.abs(u-i)){function t(){for(var e=0;e<l.length;e++){var t=l[e];"function"==typeof t&&m.try2Call(t,null,n,i,r,a)}}e?setTimeout(t,0):t()}return c},(0,m.setDftValue)(c,{getLayoutWidth:V,getLayoutHeight:E,getBrowserWidth:I,getBrowserHeight:A,isLayoutPortrait:P,isLayoutLandscape:function(){return!P()},isBrowserPortrait:C,isBrowserLandscape:O,getLayoutWidthHeightRatio:function(){return I()/A()},getBrowserWidthHeightRatio:function(){return I()/A()},getExpectedWidthHeightRatio:function(){return s},setExpectedWidthHeightRatio:function(e){return s=e,c},init:function(e){return n?a.warn("Layout was initialized already."):(n=!0,(e=m.setDftValue(e,{autoReLayoutWhenResize:!0,layoutAsMobilePortrait:f,layoutAsMobileLandscape:g,layoutAsTabletLandscape:w,layoutAsTabletPortrait:d,layoutAsPcPortrait:h,layoutAsPcLandscape:v})).autoReLayoutWhenResize&&y.addChangeListener(r),"function"==typeof e.layoutAsMobilePortrait&&(f=e.layoutAsMobilePortrait),"function"==typeof e.layoutAsMobileLandscape&&(g=e.layoutAsMobileLandscape),"function"==typeof e.layoutAsTabletPortrait&&(d=e.layoutAsTabletPortrait),"function"==typeof e.layoutAsTabletLandscape&&(w=e.layoutAsTabletLandscape),"function"==typeof e.layoutAsPcPortrait&&(h=e.layoutAsPcPortrait),"function"==typeof e.layoutAsPcLandscape&&(v=e.layoutAsPcLandscape)),c},doLayout:r,addLayoutChangeListener:function(e){if(-1===l.indexOf(e))return l.push(e),c},removeLayoutChangeListener:function(e){var t=l.indexOf(e);if(-1!==t)return l.splice(t,1),c}}),Object.freeze&&Object.freeze(c),c);function S(){return i.querySelector("[data-view-container]")||document.body}function V(){var e=S(),t=m.getComputedStyle(e),n=Number(t.paddingLeft.replace(/px/,"")),i=Number(t.paddingRight.replace(/px/,""));return isNaN(n)&&(n=0),isNaN(i)&&(i=0),e.clientWidth-n-i}function E(){var e=S(),t=m.getComputedStyle(e),n=Number(t.paddingTop.replace(/px/,"")),i=Number(t.paddingBottom.replace(/px/,""));return isNaN(n)&&(n=0),isNaN(i)&&(i=0),e.clientHeight-n-i}function I(){return window.innerWidth||i.clientWidth}function A(){return window.innerHeight||i.clientHeight}function P(){return V()<=E()}function C(){return I()<=A()}function O(){return!C()}e[t].layout=b}(window,"View"),function(e){var g=e.View.util,t=function(){window;function l(e,t){return(e=e||{})[t]=e[t]||{},e[t]}var c=/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),f="  __com.soft.plugin.touch#"+(new Date).getTime()+"__  ";return{addTapListener:function(o,e,u){if(c){var s=l(o,f+".tap");if(s.callbacks=s.callbacks||[],-1==s.callbacks.indexOf(e)){s.callbacks.push(e),(u=g.setDftValue(u,{timespan:500,delta:{},useCapture:!1})).delta=g.setDftValue(u.delta,{x:10,y:15});var t=l(o,f+".tap.meta");null==t.touchstart&&(t.touchstart=function(e){var t=e.changedTouches?e.changedTouches[0]:e;s.startX=t.screenX,s.startY=t.screenY,s.startTimestamp=Date.now()},o.addEventListener("touchstart",t.touchstart)),null==t.touchend&&(t.touchend=function(e){var t=e.changedTouches?e.changedTouches[0]:e;s.stopX=t.screenX,s.stopY=t.screenY,s.stopTimestamp=Date.now();var n=s.stopTimestamp-s.startTimestamp,i=Math.abs(s.stopX-s.startX),r=Math.abs(s.stopY-s.startY);if(n<=u.timespan&&i<=u.delta.x&&r<=u.delta.y)for(var a=0;a<s.callbacks.length;a++)g.try2Call(s.callbacks[a],o,e)},o.addEventListener("touchend",t.touchend,u.useCapture))}}else o.addEventListener?o.addEventListener("click",e):o.attachEvent("onclick",e)},removeTapListener:function(e,t,n){if(c){if(e.hasOwnProperty(f)){var i=l(e,f+".tap"),r=i.callbacks.indexOf(t);if(-1!=r&&(i.callbacks.splice(r,1),0==i.callbacks.length)){var a=l(e,f+".tap.meta");e.removeEventListener("touchstart",a.touchstart),e.removeEventListener("touchend",a.touchend,n),delete e[f].tap}}}else e.removeEventListener?e.removeEventListener("click",t):e.detachEvent("onclick",t)}}}();e.View.touch=t}(window),function(e){var t=e.View.util;e.View.ViewContext=function(){var n={};t.defineReadOnlyProperty(this,"has",function(e){return e in n}),t.defineReadOnlyProperty(this,"set",function(e,t){return n[e]=t,this}),t.defineReadOnlyProperty(this,"get",function(e){return n[e]}),t.defineReadOnlyProperty(this,"remove",function(e){var t=n[e];return delete n[e],t}),t.defineReadOnlyProperty(this,"clear",function(){return n={},this})}}(window),function(e){var o=e.View.Logger.globalLogger,u={};e.View.ViewConfiguration=function(t,n,i){var r,e=t,a=u;this.getName=function(){return e},this.getValue=function(e){return u!==a?a:arguments.length<1?void 0:e},this.setValue=function(e,t){return arguments.length<2&&(t=!1),!t&&u!==a||(a=e),this},this.getApplication=function(){return r},this.setApplication=function(e){return"function"!=typeof e?o.warn("Configuration application should be of type: 'Function'."):r=e,this},this.apply=function(){if("function"==typeof r)try{r.call(this,a)}catch(e){o.error("Fail to apply configuration: {} = {} for view of id: '{}' namespace: '{}'\n{}",t,String(a),n,i,e),e instanceof Error?console.error(e,e.stack):console.error(e)}return this},this.reflectToDom=function(){return null==n||""===n.trim()||(View.ifExists(n,i)?View.ofId(n,i).getDomElement().setAttribute("data-viewconfig_"+this.getName(),String(this.getValue())):o.warn("No view of id '{}' namespace: '{}' found to reflect view config: {}={}.",n,i,this.getName(),this.getValue())),this},Object.freeze(this)}}(window),function(e,t){var a=e[t].util,o=e[t].ViewConfiguration;e[t].ViewConfigurationSet=function(n,i){var r={};this.has=function(e){return e in r},this.get=function(e){var t;return e in r?t=r[e]:(t=new o(e,n,i),r[e]=t),t},this.applyAll=function(){var n=Object.keys(r).map(function(e){return r[e]});if(0!==n.length)return setTimeout(function(){for(var e=0;e<n.length;e++){var t=n[e];a.try2Call(t.apply,t)}},0),this},this.listAll=function(){return Object.keys(r)}}}(window,"View"),function(e,t){function u(e,t,n){var i=l.isEmptyString(t,!0)||f===t?"":"@"+String(t),r=String(e)+i,a=(null==n?[]:Object.keys(n)).reduce(function(e,t){return e+"&"+l.xEncodeURIComponent(t)+"="+l.xEncodeURIComponent(n[t])},"");return 0<a.length&&(r+="!"+a.substring(1)),r}function s(e,t,n,i){arguments.length<3&&(i=null),arguments.length<2&&(n=l.getUniqueString()),n=n||l.getUniqueString(),l.defineReadOnlyProperty(this,"viewId",e),l.defineReadOnlyProperty(this,"viewNamespace",t),l.defineReadOnlyProperty(this,"sn",n),l.defineReadOnlyProperty(this,"options",i),l.defineReadOnlyProperty(this,"flag",r),this.toString=function(){return JSON.stringify(this)},this.clone=function(){return JSON.parse(this.toString())}}var l=e[t].util,c=e[t].Logger.globalLogger,n="ViewState_",r=l.randomString(n),f="default",g=[],d=-1;s.isConstructorOf=function(e){return null!=e&&"object"==typeof e&&(e.hasOwnProperty("viewId")&&e.hasOwnProperty("sn")&&String(e.flag).startsWith(n))},s.pushViewState=function(e,t,n,i){arguments.length<4&&(i=null),arguments.length<3&&(n=l.getUniqueString()),(arguments.length<2||l.isEmptyString(t,!0))&&(t=f),n=n||l.getUniqueString();var r=new s(e,t,n,i).clone();c.log("↓ {}",JSON.stringify(r)),l.env.isHistoryPushPopSupported?history.pushState(r,"","#"+u(e,t,i)):location.hash=u(e,t,i),g.push(r),d++,w(),View.currentState=r},s.replaceViewState=function(e,t,n,i){arguments.length<4&&(i=null),arguments.length<3&&(n=l.getUniqueString()),(arguments.length<2||l.isEmptyString(t,!0))&&(t=f),n=n||l.getUniqueString();var r=new s(e,t,n,i).clone();if(c.log("% {}",JSON.stringify(r)),l.env.isHistoryPushPopSupported?history.replaceState(r,"","#"+u(e,t,i)):location.hash=u(e,t,i),0===g.length)g.push(r),d++;else{var a=g[d-1],o=g[d+1];null!=a&&a.sn===n?d--:null!=o&&o.sn===n?d++:g[d]=r,w()}View.currentState=r},s.getStackSize=function(){return g.length},s.ifCanGoBack=function(){return 0<d};var w=function(){c.debug("View state stack: {}, {}",g.map(function(e){return e.sn}),d)};e[t].ViewState=s}(window,"View"),function(e,t){var r,s,l,c,f,g=e[t].util,d=e[t].layout,w=e[t].Logger.globalLogger,h=document.documentElement,p={},n=(r={},l=s=-1,f=c=0,a.ofId=function(e,t){var n=e+"@"+t;if(n in r)return r[n];var i=new a(e,t);return r[n]=i},a);function a(n,i){var t=function(){},r=!0,a=50;g.defineReadOnlyProperty(this,"setLayoutAction",function(e){return"function"!=typeof e?w.error("Layout action for view of id: '{}' namespace: '{}' should be of type: Function.",n,i):t!=e&&(p,t=e),this}),g.defineReadOnlyProperty(this,"getLayoutAction",function(){return t}),g.defineReadOnlyProperty(this,"doLayout",function(){return"function"!=typeof t||((.05<Math.abs(c-s)||.05<Math.abs(f-l))&&(h.offsetWidth=h.offsetHeight),t(),s=c,l=f),this}),g.defineReadOnlyProperty(this,"setLayoutCushionTime",function(e){return null==e||isNaN(e=Number(e))||e<0?w.error("Invalid layout cushion time. Should be a digit greater than or equal to 0."):a=e,this}),g.defineReadOnlyProperty(this,"getLayoutCushionTime",function(e){return a}),g.defineReadOnlyProperty(this,"setIfLayoutWhenLayoutChanges",function(e){return r=e,this});var o,u=this;d.addLayoutChangeListener(function(e,t){r&&View.ofId(n,i).isActive()&&(w.debug("Layout changes, doing layout for view of id: '{}' namespace: '{}'. Width: {}, height: {}",n,i,e,t),c=e,f=t,clearTimeout(o),0<a?o=setTimeout(function(){u.doLayout()},a):u.doLayout())})}e[t].ViewLayout=n}(window,"View"),function(e){var u=e.View.util,i=function(){function r(e,t){arguments.length<2&&(timeBasedUniqueString=u.getUniqueString()),timeBasedUniqueString=timeBasedUniqueString||u.getUniqueString(),u.defineReadOnlyProperty(this,"serialNumber",e),u.defineReadOnlyProperty(this,"sn",timeBasedUniqueString),u.defineReadOnlyProperty(this,"flag",n),this.toString=function(){return JSON.stringify(this)},this.clone=function(){return JSON.parse(this.toString())}}var t="OperationState_",n=u.randomString(t);r.isConstructorOf=function(e){return null!=e&&"object"==typeof e&&(e.hasOwnProperty("serialNumber")&&e.hasOwnProperty("sn")&&String(e.flag).startsWith(t))};var a=null,o={};return r.pushState=function(e,t){var n=new i(e).clone();history.pushState(n,"",""),a=n,o[e]=t},window.addEventListener("popstate",function(e){if(r.isConstructorOf(a)){var t=e.state&&e.state.sn&&e.state.sn<a.sn,n=o[a.serialNumber];t&&null!=n&&(u.try2Call(n),delete o[a.serialNumber])}var i=e.state;a=r.isConstructorOf(i)?i:null}),r}();e.View.OperationState=i}(window),function(e,t){function n(r){var a=[],n={},o={},u=!1;this.getName=function(){return r},this.setSequence=function(e){return u?s.error("Sequence is prohibited to change while executing."):Array.isArray(e)&&(e=e.map(function(e){return null==e?"":String(e).trim().toLowerCase()}).reduce(function(e,t){return i.isEmptyString(t,!0)||-1!==e.indexOf(t)||e.push(t),e},[]),a=e),this},this.setProperty=function(e,t){return n[String[e]]=t,this},this.setProperties=function(e){if(null==e||"object"!=typeof e)return this;for(var t in e)this.setProperty(t,e[t]);return this},this.getProperty=function(e,t){return(e=String(e))in n?n[e]:1<arguments.length?t:null},this.setHandle=function(e,t){return u?s.error("Handle is prohibited to change while executing."):o[String(e).toLowerCase()]=t,this},this.exec=function(){var n,i;s.debug("Executing chained handle: {}",r),u=!0;var e=new Promise(function(e,t){n=e,i=t});if(e.then(function(){u=!1},function(){u=!1}),0===a.length)return n(),e;var t=function(r){r>=a.length?n():new Promise(function(e,n){var i=a[r],t=o[i];if(s.debug("Executing handle: {}",i),null!=t)try{t(e,function(e){var t="Handle of name: "+i+"rejects";1<arguments.length?s.error(t,e):s.error(t),n(e)})}catch(e){s.error("Error occurred while executing handle of name: "+i),console.error(e),n(e)}else e()}).then(function(){t(r+1)},i)};return t(0),e}}var i=e[t].util,s=e[t].Logger.globalLogger,r={};n.ofName=function(e){var t=r[e];return null==t&&(t=r[e]=new n(e)),t},e[t].ChainedHandle=n}(window,"View"),window.View.viewAttribute={attr$view:"data-view",attr$viewId:"data-view-id",attr$view_namespace:"data-view-namespace",attr$view_default:"data-view-default",attr$view_directly_accessible:"data-view-directly-accessible",attr$view_group:"data-view-group",attr$view_fallback:"data-view-fallback",attr$view_rel:"data-view-rel",attr$view_rel_namespace:"data-view-rel-namespace",attr$view_rel_type:"data-view-rel-type",attr$view_rel_disabled:"data-view-rel-disabled",attr$view_title:"data-view-title",attr$view_container:"data-view-container",attr$view_os:"data-view-os",attr$view_whr:"data-view-whr",attr$view_state:"data-view-state",attr$active_view_id:"data-active-view-id",attr$active_view_namespace:"data-active-view-namespace"},function(e,t){e[t].Logger.globalLogger;var a=e[t].util,n=":forward",i=":default-view";e[t].viewRepresentation={PSVIEW_BACK:":back",PSVIEW_FORWARD:n,PSVIEW_DEFAULT:i,isPseudoView:function(e){return":back"===e||n===e||i===e},parseViewInfoFromHash:function(e){if(""===e)return null;var t=e.match(/^#([\w$\-]+)(?:@([^!]+))?(?:!+(.*))?/);if(null==t)return null;var n=t[1],i=t[2],r=a.parseParams(t[3]);return a.isEmptyString(i,!0)&&(i="default"),{viewId:n,viewNamespace:i,options:r}}}}(window,"View"),function(e,t){e[t].Logger.globalLogger;function i(e,t,n){a[e+"@"+t]=n}var r=e[t].viewRepresentation,a={};e[t].viewParameter={hasParameters:function(e,t){return e+"@"+t in a},getParameters:function(e,t){return a[e+"@"+t]},setParameters:i,removeParameters:function(e,t){delete a[e+"@"+t]},setViewParameters:function(e,t,n){if(!View.ifExists(e,t)&&!r.isPseudoView(e))throw new Error("View of id: '"+e+"' within namespace: '"+t+"' does not exist.");if(void 0===n&&(n=null),"object"!=typeof n)throw new Error("Parameters specified should be an object or null.");return i(e,t,n),View},clearViewParameters:function(e,t){return delete a[e+"@"+t],View}}}(window,"View"),function(e,t){function s(e){e in i||(i[e]=[])}function l(e){if(!(e instanceof HTMLElement))return null;var t=e.getAttribute(m.attr$viewId);return w.isEmptyString(t,!0)&&(t=e.id),t}function g(){var e=document.querySelector("["+m.attr$view_container+"]");return null==e&&(e=document.body),e}function a(e){if(!(e instanceof HTMLElement))return!1;var t=e.getAttribute(m.attr$view);return null!=t&&("true"===(t=t.toLowerCase())&&!w.isEmptyString(l(e),!0))}function r(t){1<arguments.length&&(t=String(t).toLowerCase());var e=[];for(var n in i)e=e.concat(i[n]);return arguments.length<1||w.isEmptyString(t,!0)?e:e.filter(function(e){return t===e.getGroupName()})}function o(e){function t(){var e=o.getId(),t=o.getNamespace();function n(t,e){try{o.fire(t,i,e)}catch(e){d.error("Error occurred while firing event: {} with data: {}",t,i),e instanceof Error?console.error(e,e.stack):console.error(e)}}p.clearViewParameters(e,t),l?p.hasParameters(v.PSVIEW_BACK,"")&&(p.setViewParameters(e,t,p.getParameters(v.PSVIEW_BACK,"")),p.clearViewParameters(v.PSVIEW_BACK,"")):c?p.hasParameters(v.PSVIEW_FORWARD,"")&&(p.setViewParameters(e,t,p.getParameters(v.PSVIEW_FORWARD,"")),p.clearViewParameters(v.PSVIEW_FORWARD,"")):p.setViewParameters(e,t,s);var i={sourceView:a,type:u,params:s};a&&a.getDomElement().classList.remove("active"),a&&a.fire("leave",{targetView:o,type:u}),n("beforeenter",!1),o.getDomElement().classList.add("active"),h.ofId(e,t).doLayout(),View.fire("change",f,!1),o.isReady()||(y.push(e),n("ready",!1)),n("enter",!1),n("afterenter",!1);var r=g();r.setAttribute(m.attr$active_view_id,o.id),r.setAttribute(m.attr$active_view_namespace,o.namespace),View.fire("afterchange",f)}var a=(e=w.setDftValue(e,{srcView:null,targetView:null,type:View.SWITCHTYPE_VIEWNAV,withAnimation:!0,params:null})).srcView,o=e.targetView,u=function(e){w.isEmptyString(e,!0)&&(e=View.SWITCHTYPE_VIEWNAV);var t=w.ifStringEqualsIgnoreCase(e,View.SWITCHTYPE_VIEWNAV),n=w.ifStringEqualsIgnoreCase(e,View.SWITCHTYPE_VIEWCHANGE),i=w.ifStringEqualsIgnoreCase(e,View.SWITCHTYPE_HISTORYBACK),r=w.ifStringEqualsIgnoreCase(e,View.SWITCHTYPE_HISTORYFORWARD);return i||r||t||n||(e=View.SWITCHTYPE_VIEWNAV),e}(e.type),s=e.params,l=w.ifStringEqualsIgnoreCase(u,View.SWITCHTYPE_HISTORYBACK),c=w.ifStringEqualsIgnoreCase(u,View.SWITCHTYPE_HISTORYFORWARD),f={currentView:a,targetView:o,type:u,params:s};View.fire("beforechange",f,!1),e.withAnimation&&n?n.call(null,a?a.getDomElement():null,o.getDomElement(),u,t):t()}var d=e[t].Logger.globalLogger,w=e[t].util,h=e[t].ViewLayout,p=e[t].viewParameter,v=e[t].viewRepresentation,m=e[t].viewAttribute,i={},y=[],n=null,c="default";e[t].viewInternalVariable={defaultNamespace:c,defaultWidthHeightRatio:"320/568",viewInstancesMap:i,readyViews:y,get viewSwitchAnimation(){return n},set viewSwitchAnimation(e){n=e},getPotentialViewId:l,getViewContainerDomElement:g,getViewDomElements:function(){var e,t=g(),n=[],i=document.querySelectorAll("*["+m.attr$view+"=true]");for(e=0;e<i.length;e++)a(i[e])&&n.push(i[e]);for(i=t.querySelectorAll("["+m.attr$viewId+"]"),e=0;e<i.length;e++){var r=l(i[e]);w.isEmptyString(r,!0)||-1!==n.indexOf(i[e])||(i[e].setAttribute(m.attr$view,"true"),n.push(i[e]))}return n},getViewDomElementOfId:function(e,t){(arguments.length<2||w.isEmptyString(t,!0))&&(t=c),s(t);var n=document.querySelectorAll("["+m.attr$view+"=true]");if(0===n.length)return null;for(var i=null,r=0;r<n.length;r++){var a=n[r],o=l(a),u=a.getAttribute(m.attr$view_namespace);if(w.isEmptyString(u,!0)&&(u=c),e===o&&u===t){i=a;break}}return i},getRenderingViewId:function(){return null==View.currentState?null:View.currentState.viewId},buildNamespace:s,getFinalView:function(e,t){(arguments.length<2||"string"!=typeof t||w.isEmptyString(t,!0))&&(t=c),s(t);var n=null;return w.isEmptyString(e,!0)||!View.ifExists(e,t)?n=function(){var e=View.getActiveView();return null==e&&(e=View.getDefaultView()),e}():(n=View.ofId(e,t)).isDirectlyAccessible()||(n=n.getFallbackView()),n},listAllViews:r,findFirstViewIdOfGroupName:function(e){if(w.isEmptyString(e,!0))return d.error("Empty view group name!"),null;e=String(e).trim().toLowerCase();var t=r(e);if(null==t||0===t.length)return d.error("No view of group: {} found.",e),null;var n=t.map(function(e){return e.getId()}),i=n[0];return d.info("Found {} views of group: {}: {}, using the first one: {}.",n.length,e,n,i),i},switchView:o,showView:function(e,t,n){if((arguments.length<2||"string"!=typeof t||w.isEmptyString(t,!0))&&(t=c),s(t),n=w.setDftValue(n,{},!0),!View.ifExists(e,t))throw d.log("Trying to navigate to view: '{}' within namespace: '{}' with params: {}, options: {}",e,t,n.params,n.options),new Error("Target view: '"+e+"' within namespace: '"+t+"' does not exist!");var i=View.getActiveView();d.log("{}@{} → {}@{} {}",i?i.getId():null,i?i.getNamespace():null,e,t,JSON.stringify(n));var r=View.ofId(e,t);return n.srcView=i,n.targetView=r,o(n),View}}}(window,"View"),function(e,t){var l=e[t].util,n=e[t].eventDrive,c=e[t].Logger,f=e[t].ViewConfigurationSet,g=e[t].ViewContext,d=e[t].ViewLayout,w=e[t].viewRepresentation,h=e[t].viewParameter,p=e[t].viewAttribute,v=e[t].viewInternalVariable,m=c.globalLogger,y=function(r,a){(arguments.length<2||l.isEmptyString(a,!0))&&(a=v.defaultNamespace);var o=null,u=document.querySelectorAll("["+p.attr$view+"=true]");if(0===u.length||function(){for(var e=0;e<u.length;e++){var t=u[e],n=v.getPotentialViewId(t),i=t.getAttribute(p.attr$view_namespace);if(l.isEmptyString(i,!0)&&(i=v.defaultNamespace),r===n&&i===a){o=t;break}}return null==o}())throw new Error("View of id: '"+r+"' within namespace: '"+a+"' does not exist!");var i={},e=new g,t=new f(r,a);n(this,o);var s=this.fire;this.fire=function(e,t,n){i[e]=t,s(e,t,n)},l.defineReadOnlyProperty(this,"id",r),l.defineReadOnlyProperty(this,"namespace",a),l.defineReadOnlyProperty(this,"logger",c.ofName("View#"+r)),l.defineReadOnlyProperty(this,"config",t),l.defineReadOnlyProperty(this,"context",e),this.getLatestEventData=function(e){return i[e]},this.getContext=function(){return e},this.clearContext=function(){return e.clear(),this},this.getId=function(){return r},this.getNamespace=function(){return a},this.getDomElement=function(){return o},this.getGroupName=function(){var e=this.getDomElement().getAttribute(p.attr$view_group);return null==e?e:e=String(e).toLowerCase()},this.find=function(e){return this.getDomElement().querySelector(e)},this.findAll=function(e){return this.getDomElement().querySelectorAll(e)},this.setLayoutAction=function(e,t){return arguments.length<2&&(t=!0),d.ofId(r,a).setIfLayoutWhenLayoutChanges(!!t).setLayoutAction(e),this},this.getLayoutAction=function(){return d.ofId(r,a).getLayoutAction()},this.hasParameter=function(e){if(null==e)return!1;var t=h.getParameters(this.getId(),this.getNamespace());return null!=t&&e in t},this.getParameter=function(e){var t=h.getParameters(this.getId(),this.getNamespace());return arguments.length<1?t:null==t?null:t[e]},this.seekParameter=function(e){if(this.hasParameter(e))return this.getParameter(e);if(y.hasActiveViewOption(e))return y.getActiveViewOption(e);var t=new RegExp("\\b"+e+"\\b=([^&\\?]*)"),n=location.search.match(t);return null==n?null:n=decodeURIComponent(n[1])},this.isReady=function(){return-1!==v.readyViews.indexOf(this.getId())},this.isActive=function(){return this.getDomElement().classList.contains("active")},this.isDefault=function(){return/true/i.test(this.getDomElement().getAttribute(p.attr$view_default))},this.isDirectlyAccessible=function(){var e=this.getDomElement().getAttribute(p.attr$view_directly_accessible);return e=null==e?null:e.toLowerCase(),y.isDirectlyAccessible()?"false"!==e:"true"===e},this.setAsDirectlyAccessible=function(e){return arguments.length<1&&(e=!0),this.getDomElement().setAttribute(p.attr$view_directly_accessible,String(e)),this},this.setTitle=function(e){return null==e?this.getDomElement().removeAttribute(p.attr$view_title):(e=String(e),this.getDomElement().setAttribute(p.attr$view_title,e),this.isActive()&&(document.title=e)),this},this.getTitle=function(e){return this.getDomElement().getAttribute(p.attr$view_title)},this.setFallbackViewId=function(e){if(l.isEmptyString(e,!0))return this;if(l.ifStringEqualsIgnoreCase(w.PSVIEW_DEFAULT,e)){var t=y.getDefaultView();if(null==t)return m.error("No default view found."),this;e=t.getId()}else if(/^~/.test(e)){var n=e.substring(1),i=v.findFirstViewIdOfGroupName(n);if(null==i)return m.warn("No view of group: {} found.",n),this;e=i}return y.ifExists(e)?this.getId()===e||this.getDomElement().setAttribute(p.attr$view_fallback,e):m.warn("No view of id: {} found.",e),this},this.getFallbackView=function(){for(var e=this,t=[this.getId()];;){var n=e.getDomElement().getAttribute(p.attr$view_fallback);if(l.ifStringEqualsIgnoreCase(w.PSVIEW_DEFAULT,n))return y.getDefaultView();if(/^~/.test(n)){var i=n.substring(1),r=v.findFirstViewIdOfGroupName(i);if(null==r)return y.getDefaultView();n=r}if(null==n||!y.ifExists(n))return m.warn("View: "+e.getId()+" is not permited to access directly, and no fallback configuration found, thus returning the default view"),y.getDefaultView();if(e=y.ofId(n),-1!==t.indexOf(e.getId()))return m.error("Cyclical reference of view on fallback configuration on view: {}. Chain: {}, view id: {}",this.getId(),t,e.getId()),y.getDefaultView();if(e.isDirectlyAccessible())return e;t.push(n)}},Object.freeze&&Object.freeze(this)};n(y),l.defineReadOnlyProperty(y,"SWITCHTYPE_HISTORYFORWARD","history.forward"),l.defineReadOnlyProperty(y,"SWITCHTYPE_HISTORYBACK","history.back"),l.defineReadOnlyProperty(y,"SWITCHTYPE_VIEWNAV","view.nav"),l.defineReadOnlyProperty(y,"SWITCHTYPE_VIEWCHANGE","view.change"),e[t].ViewConstructor=y}(window,"View"),function(e, t){var w=e[t].util,n=e[t].Logger,a=e[t].touch,o=e[t].layout,h=e[t].ViewConstructor,p=e[t].ViewState,i=e[t].OperationState,r=(e[t].ViewLayout,e[t].ChainedHandle),v=e[t].viewRepresentation,u=e[t].viewParameter,d=e[t].viewAttribute,m=e[t].viewInternalVariable,y=n.globalLogger;h.currentState=null,h.Logger=n,h.layout=o,h.checkIfBrowserHistorySupportsPushPopAction=function(){return w.env.isHistoryPushPopSupported},h.getViewContainerDomElement=m.getViewContainerDomElement,h.find=function(e,t){return 1===arguments.length&&(t=e,e=h.getViewContainerDomElement()),e.querySelector(t)},h.findAll=function(e,t){return 1===arguments.length&&(t=e,e=h.getViewContainerDomElement()),e.querySelectorAll(t)},h.ofId=function(e,t){(arguments.length<2||w.isEmptyString(t,!0))&&(t=m.defaultNamespace),m.buildNamespace(t);for(var n=m.viewInstancesMap[t],i=0;i<n.length;i++)if(n[i].getId().trim()===e.trim()&&n[i].getNamespace().trim()===t.trim())return n[i];var r=new h(e,t);return n.push(r),r},h.ifExists=function(e,t){(arguments.length<2||w.isEmptyString(t,!0))&&(t=m.defaultNamespace),m.buildNamespace(t);for(var n=m.viewInstancesMap[t],i=0;i<n.length;i++)if(n[i].getId().trim()===e.trim())return!0;return!1},h.listAll=m.listAllViews,h.listAllGroups=function(){return m.listAllViews().reduce(function(e,t){var n=t.getGroupName();return w.isEmptyString(n,!0)||-1!==e.indexOf(n)||e.push(n),e},[])},h.setAsDefault=function(e,t){if((arguments.length<2||w.isEmptyString(t,!0))&&(t=m.defaultNamespace),m.buildNamespace(t),w.isEmptyString(e,!0))return y.warn("No view id supplied to set as default."),h;for(var n=m.getViewDomElements(),i=0;i<n.length;i++)n[i].removeAttribute(d.attr$view_default);var r=m.getViewDomElementOfId(e,t);return null==r?y.error("No view dom element of id: '{}' namespace: '{}' found to set as default.",e,t):r.setAttribute(d.attr$view_default,"true"),h},h.isDirectlyAccessible=function(){var e=document.documentElement.getAttribute(d.attr$view_directly_accessible);return w.ifStringEqualsIgnoreCase("true",e)},h.setIsDirectlyAccessible=function(e){return document.documentElement.setAttribute(d.attr$view_directly_accessible,String(!!e).toLowerCase()),h},h.setViewIsDirectlyAccessible=function(e,t,n){if(arguments.length<2)throw new Error("Illegal argument length. Call with arguments: 'viewId[, viewNamespace], accessible'");arguments.length<3&&(n=t,t=m.defaultNamespace);var i=m.getViewDomElementOfId(e,t);return null==i?y.error("No view of id: {}, namespace: {} found to set is directly accessible or not",e,t):i.setAttribute(d.attr$view_directly_accessible,String(!!n).toLowerCase()),h},h.getActiveView=function(){for(var e=m.listAllViews(),t=0;t<e.length;t++)if(e[t].isActive())return e[t];return null},h.getDefaultView=function(){for(var e=m.listAllViews(),t=0;t<e.length;t++)if(e[t].isDefault())return e[t];return null},h.setSwitchAnimation=function(e){if(!(e instanceof Function))throw new Error("Invalid argument, type of 'Function' is required.");return m.viewSwitchAnimation=e,h},h.getSwitchAnimation=function(){return m.viewSwitchAnimation},h.getActiveViewOptions=function(){var e=v.parseViewInfoFromHash(location.hash);return null==e?null:e.options},h.hasActiveViewOption=function(e){var t=h.getActiveViewOptions();return null!=t&&e in t},h.getActiveViewOption=function(e){var t=h.getActiveViewOptions();return null==t?null:t[e]},h.setActiveViewOption=function(e,t){if(w.isEmptyString(e,!0))return y.error("Option name should not be empty."),h;var n=h.getActiveView();if(null==n)return y.error("No active view to set option {} = {}.",e,t),h;e=String(e).trim(),t=String(t).trim();var i=h.getActiveViewOptions()||{};return i[e]=t,p.replaceViewState(n.getId(),n.getNamespace(),h.currentState?h.currentState.sn:null,i),h},h.passBy=function(e,t){if((arguments.length<2||"string"!=typeof t||w.isEmptyString(t,!0))&&(t=m.defaultNamespace),m.buildNamespace(t),w.ifStringEqualsIgnoreCase(v.PSVIEW_DEFAULT,e)){var n=h.getDefaultView();if(null==n)return y.error("No default view found."),h;e=n.getId()}if(/^~/.test(e)){var i=e.substring(1),r=m.findFirstViewIdOfGroupName(i);if(null==r)return h;e=r}return h.ifExists(e,t)?p.pushViewState(e,t):console.error(new Error("Target view: '"+e+"' within namespace: '"+t+"' does not exist!")),h},h.getChainedHandleByName=function(e){return r.ofName(e)},h.navTo=function(e,t,n){(arguments.length<2||"string"!=typeof t||w.isEmptyString(t,!0))&&(n=t,t=m.defaultNamespace),m.buildNamespace(t),e=e.trim(),n=w.setDftValue(n,{});m.getRenderingViewId(),h.getActiveView();if(w.ifStringEqualsIgnoreCase(v.PSVIEW_BACK,e))return h.back(n),h;if(w.ifStringEqualsIgnoreCase(v.PSVIEW_FORWARD,e))return h.forward(n),h;if(w.ifStringEqualsIgnoreCase(v.PSVIEW_DEFAULT,e)){var i=h.getDefaultView();if(null==i)return y.error("No default view found."),h;e=i.getId()}if(/^~/.test(e)){var r=e.substring(1),a=m.findFirstViewIdOfGroupName(r);if(null==a)return h;e=a}if(h.ifExists(e,t))return n.type=h.SWITCHTYPE_VIEWNAV,p.pushViewState(e,t,null,null==n?null:n.options),m.showView(e,t,n),h;y.log("Trying to navigate to view: '{}' within namespace: '{}' with params: {}, options: {}",e,t,n.params,n.options);var o=new Error("Target view: '"+e+"' within namespace: '"+t+"' does not exist! Firing event 'viewnotexist'...");return console.error(o),h.fire("viewnotexist",{targetViewId:e,targetViewNamespace:t}),h},h.changeTo=function(e,t,n){(arguments.length<2||"string"!=typeof t||w.isEmptyString(t,!0))&&(n=t,t=m.defaultNamespace),m.buildNamespace(t),n=w.setDftValue(n,{});m.getRenderingViewId(),h.getActiveView();if(w.ifStringEqualsIgnoreCase(v.PSVIEW_DEFAULT,e)){var i=h.getDefaultView();if(null==i)return void y.error("No default view found.");e=i.getId()}if(/^~/.test(e)){var r=e.substring(1),a=m.findFirstViewIdOfGroupName(r);if(null==a)return h;e=a}if(h.ifExists(e,t))return n.type=h.SWITCHTYPE_VIEWCHANGE,p.replaceViewState(e,t,null,null==n?null:n.options),m.showView(e,t,n),h;y.log("Trying to navigate to view: '{}' within namespace: '{}' with params: {}, options: {}",e,t,n.params,n.options);var o=new Error("Target view: '"+e+"' within namespace: '"+t+"' does not exist! Firing event 'viewnotexist'...");return console.error(o),h.fire("viewnotexist",{targetViewId:e,targetViewNamespace:t}),h};var s=null;h.setNoViewToNavBackAction=function(e){if("function"!=typeof e)throw new Error("Invalid argument! Type of 'Function' is needed.");return s=e,h},h.back=function(e){return u.clearViewParameters(v.PSVIEW_BACK),null!=e&&"params"in e&&u.setViewParameters(v.PSVIEW_BACK,"",e.params),h.ifCanGoBack()||"function"!=typeof s?history.go(-1):w.try2Call(s),h},h.forward=function(e){return u.clearViewParameters(v.PSVIEW_FORWARD),null!=e&&"params"in e&&u.setViewParameters(v.PSVIEW_FORWARD,"",e.params),history.go(1),h};var l=document.title;h.setDocumentTitle=function(e){return w.isEmptyString(e,!0)?y.warn("Invalid document title: "+e):document.title=l=e,h},h.onceHistoryBack=function(e){if("function"!=typeof e)throw new Error("Invalid argument! Type of 'Function' is needed.");return i.pushState(w.randomString(),e),h},h.reDoLayout=function(){return m.listAllViews().forEach(function(e){w.try2Call(e.getLayoutAction())}),h},h.ifCanGoBack=p.ifCanGoBack;function c(e){var t=h.getActiveView(),n=null==t?null:t.getId(),i=null==t?null:t.getNamespace();y.log("{} Current: {}",w.env.isHistoryPushPopSupported?"State popped!":"Hash changed!",t&&t.getId()),y.log("↑ {}",w.env.isHistoryPushPopSupported?JSON.stringify(e.state):location.hash);var r,a,o,u=h.SWITCHTYPE_VIEWNAV,s=null;if(null==e.state){u=h.SWITCHTYPE_VIEWNAV;var l=v.parseViewInfoFromHash(location.hash);if(null==l?(s=t,g=n,d=i):(r=l.viewId,a=l.viewNamespace,null!=(s=m.getFinalView(r,a))&&(g=s.getId(),d=s.getNamespace())),null!=g){var c=g==r&&d==a;o=g==n&&d==i?h.currentState?h.currentState.options:null:c?l.options:null,p.replaceViewState(g,d,null,o),m.showView(s.getId(),s.getNamespace(),{type:u,options:o})}}else if(p.isConstructorOf(e.state)){var f=e.state;r=f.viewId,a=f.viewNamespace,o=h.ifExists(r,a)?(s=h.ofId(r,a),f.options):(y.warn("Popped view: '"+r+"' within namespace: '"+a+"' does not exist, keeping current."),s=t,null);var g=s.getId(),d=s.getNamespace();null!=h.currentState&&(u=f.sn<h.currentState.sn?h.SWITCHTYPE_HISTORYBACK:h.SWITCHTYPE_HISTORYFORWARD),p.replaceViewState(g,d,f.sn,o),m.showView(g,d,{type:u,options:o})}else y.info("Skip state: {}",e.state)}function f(){g(),l=document.title,document.documentElement.setAttribute(d.attr$view_os,w.env.isIOS?"ios":w.env.isAndroid?"android":w.env.isWindowsPhone?"wp":"unknown"),window.addEventListener(w.env.isHistoryPushPopSupported?"popstate":"hashchange",c),function(){var e=document.querySelectorAll("["+d.attr$view_container+"]");if(0===e.length)document.body.setAttribute(d.attr$view_container,"");else for(var t=1; t<e.length; t++)e[t].removeAttribute(d.attr$view_container)}(),h.getViewContainerDomElement().setAttribute(d.attr$view_state,"initing");var i=m.getViewDomElements(),r=[];[].forEach.call(i,function(t){var e=t.getAttribute(d.attr$view_namespace);w.isEmptyString(e,!0)&&(e=m.defaultNamespace,t.setAttribute(d.attr$view_namespace,e));var n=m.getPotentialViewId(t),i=h.ofId(n,e);-1===r.indexOf(i)?(r.push(i),t.classList.remove("active"),t.classList.add("view"),i.on("enter",function(){var e=t.getAttribute(d.attr$view_title);document.title=null==e?l:e})):y.warn("Multiple view of id: '{}' within namespace: '{}' exists.",i.id,i.namespace)});var f=null;null!=(f=function(){for(var e=null,t=-1,n=0; n<i.length; n++)if("true"===i[n].getAttribute(d.attr$view_default)){t=n;break}if(-1!==t){e=i[t];for(n=t+1; n<i.length; n++)"true"===i[n].getAttribute(d.attr$view_default)&&i[n].removeAttribute(d.attr$view_default)}else 0!==i.length?(e=i[0]).setAttribute(d.attr$view_default,"true"):y.warn("No view exists to determine the default view.");return e}())&&f.classList.add("active"),a.addTapListener(document.documentElement,function(e){for(var t,n=e.changedTouches?e.changedTouches[0].target:e.target;null==n.getAttribute(d.attr$view_rel)&&((n=n.parentNode)instanceof HTMLElement||(n=null),null!=n););if((null!=n&&(t=n.getAttribute(d.attr$view_rel)),null!=t&&""!==t.trim())&&!("true"===n.getAttribute(d.attr$view_rel_disabled)))if(e.preventDefault(),/^(http|https|ftp):\/\//gim.test(t))window.location.href=t;else{if(/^\s*@+/.test(t)){var i=t.replace(/^\s*@+/,"").trim();return""===i?void y.warn("Empty file path for data-view-rel: '{}'",t):void(window.location.href=i)}if(w.ifStringEqualsIgnoreCase(v.PSVIEW_BACK,t))h.back();else if(w.ifStringEqualsIgnoreCase(v.PSVIEW_FORWARD,t))h.forward();else{if(w.ifStringEqualsIgnoreCase(v.PSVIEW_DEFAULT,t)){var r=h.getDefaultView();t=null==r?null:r.getId()}var a=null;if(/^~/.test(t)){var o=t.match(/^~([^!]+)(?:!+(.*))?/);if(null==o)return;var u=o[1].trim(),s=w.parseParams(o[2]),l=m.findFirstViewIdOfGroupName(u);if(null==l)return;t=l,a=s}else{var c=v.parseViewInfoFromHash("#"+t);t=c.viewId,a=c.options}var f=n.getAttribute(d.attr$view_rel_namespace);w.isEmptyString(f,!0)&&(f=m.defaultNamespace);var g=n.getAttribute(d.attr$view_rel_type);g=w.isEmptyString(g,!0)?"nav":g,/^(?:nav)|(?:change)$/.test(g)||(y.warn("Unknown view switch type: {}. {}",g,n),g="nav"),h[g+"To"](t,f,{options:a})}}},{useCapture:!0}),function(){var e=document.documentElement.getAttribute(d.attr$view_whr);if(null!=e&&""!==(e=e.trim().toLowerCase())){var t=/(\d+(?:\.\d*)?)\s*\/\s*(\d+(?:\.\d*)?)/i,n=e.match(t);null==n?(y.warn("Invalid view expected width height ratio: {}. Value such as '320/568'(iPhone 5) is valid. Using '{}' instead.",e,m.defaultWidthHeightRatio),n=m.defaultWidthHeightRatio.exec(t)):y.info("Using specified expected width height ratio: {}",e),o.setExpectedWidthHeightRatio(Number(n[1])/Number(n[2])).init();for(var i=document.querySelectorAll("input, select, textarea, *[contentEditable]"),r=0;r<i.length;r++)i[r].blur();o.doLayout(!1)}else o.init().doLayout(!1)}(),y.info("Marking View as initialized and ready"),b(),S(),function(){if(null==h.currentState){var e=null==f?null:m.getPotentialViewId(f),t=null==f?null:f.getAttribute(d.attr$view_namespace)||m.defaultNamespace,n=v.parseViewInfoFromHash(location.hash),i=null==n?null:n.viewId,r=null==n?null:n.viewNamespace,a=null==n?null:n.options,o=null,u=null,s=w.isEmptyString(e,!0);if(u=!w.isEmptyString(i,!0)&&h.ifExists(i,r)?(o=i,r):(y.warn("No view of id: '{}' namespace: '{}'(specified in the location hash) found, trying to show the default view",i,r),!s&&h.ifExists(e,t)?(o=e,t):(y.warn("No default view(id: '{}', namespace: '{}') found.",e,t),o=null)),w.isEmptyString(o,!0))y.warn("Can not determine the initial view!");else{var l=m.getFinalView(o,u);if(null!=l){o=l.getId(),u=l.getNamespace(),o==i&&u==r||(a=null),y.info("Showing view: '{}' within namespace: '{}'",o,u),p.replaceViewState(o,u,null,a);var c=h.getActiveView();m.switchView({srcView:c==l?null:c,targetView:l,withAnimation:!1,params:null})}else y.error("No final view found for view of id: '{}', namespace: '{}'",o,u)}}else y.debug("Skip showing specified view.")}()}var g,b,S,V,E,I,A,P=!1,C=!1;h.beforeInit=(I=[],g=function(){for(var e=0;e<I.length;e++)w.try2Call(I[e]);I=[]},b=function(){P=!0},function(e){return P||-1===I.indexOf(e)&&I.push(e),h}),h.ready=(A=[],S=function(){C=!0;for(var e=0;e<A.length;e++)w.try2Call(A[e]);A=[],h.getViewContainerDomElement().setAttribute(d.attr$view_state,"ready")},function(e){return C?w.try2Call(e):-1===A.indexOf(e)&&A.push(e),h}),h.setInitializer=function(e,t){if("function"==typeof e){var n="domready";arguments.length<2&&(t=n);var i="domready, rightnow".split(/\s*,\s*/);-1===i.indexOf(t)&&(y.warn("Unknown initializer exec time: {}. Supported: {}",t,i),t=n),V=e,E=t,P||"rightnow"!==t||(y.info("Calling specified view initializer right now"),e(f))}},document.addEventListener("DOMContentLoaded",function(){null==V?(y.info("Initializing View automatically on dom ready"),f()):"domready"===E&&(y.info("Calling specified view initializer on dom ready"),V(f))}),e[t]=h}(window,"View");