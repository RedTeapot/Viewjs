/**
 * View.js v1.6.0-B201903151312
 * author: Billy, wmjhappy_ok@126.com
 * license: MIT
 */
!function(e,t){if("View"in e)return void console.error("Plugin name: 'View' has already been used.");e.View={}}(window),function(e,t){var n=function(){var e=function(e,t){this.type=e,this.timestamp=(new Date).getTime(),this.data=t,Object.freeze&&Object.freeze(this)};return function(t,n){var i={},r=function(e){i[e]=i[e]||[]};t.on=function(e,t){String(e).replace(/(\s*,){2,}/,",").toLowerCase().split(/\s*,\s*/).forEach(function(e){r(e),i[e].indexOf(t)==-1&&i[e].push(t)})},t.off=function(e,t){String(e).replace(/(\s*,){2,}/,",").toLowerCase().split(/\s*,\s*/).forEach(function(e){r(e);var n=i[e].indexOf(t);n!=-1&&i[e].splice(n,1)})},t.fire=function(t,a,o){arguments.length<3&&(o=!0),String(t).replace(/(\s*,){2,}/,",").toLowerCase().split(/\s*,\s*/).forEach(function(t){var u=new e(t,a),s=function(){r(t);for(var e=0;e<i[t].length;e++){var a=i[t][e];if("function"==typeof a)try{a.call(n,u)}catch(e){console.error(e,e.stack)}}};o?setTimeout(s,0):s()})}}}();e.View.eventDrive=n}(window),function(e,t){var n=function(){var e,t,n=function(){if(0!=arguments.length){var e=arguments,t=" "+String(arguments[0]),n=1;return t=t.replace(/([^\\])\{\}/g,function(t,i){var a=e.length-1<n?"{}":String(r(e[n]));return n++,i+a}),t=t.replace(/\\\{\}/g,"{}"),t.substring(1)}},i=function(){var e=new Date,t=(e.getFullYear(),"0"+String(e.getMonth()+1));t=t.substring(t.length-2);var n="0"+String(e.getDate());n=n.substring(n.length-2);var i="0"+String(e.getHours());i=i.substring(i.length-2);var r="0"+String(e.getMinutes());r=r.substring(r.length-2);var a="0"+String(e.getSeconds());return a=a.substring(a.length-2),t+n+" "+i+":"+r+":"+a},r=function(e){if(null==e)return null;if("number"==typeof e||"string"==typeof e||"boolean"==typeof e)return e;if("function"==typeof e)return"function "+e.name+"(){...}";if("object"!=typeof e||Array.isArray(e))return e instanceof Array?"["+e.map(function(e){return r(e)}).join(", ")+"]":e;if("[object Object]"!=String(e))return String(e);var t=JSON.stringify(e);if("{}"!=t)return t;try{var n={};for(var i in e)n[i]=r(e[i]);return JSON.stringify(n)}catch(e){return t}},a=function(e){return i()+" ["+e+"]: "},o={};!function(){var n=!0;e=function(){return n},t=function(e){n=e}}();var u=function(t){var i=!0;this.isEnabled=function(){return e()&&i},this.setIsEnabled=function(e){return i=e,this},this.getName=function(){return t},this.debug=function(){if(this.isEnabled()){var e=n.apply(null,arguments);console.debug(a(t)+e)}},this.info=function(){if(this.isEnabled()){var e=n.apply(null,arguments);console.info(a(t)+e)}},this.warn=function(){if(this.isEnabled()){var e=n.apply(null,arguments);console.warn(a(t)+e)}},this.error=function(){if(this.isEnabled()){var e=n.apply(null,arguments);console.error(a(t)+e)}},this.log=function(){if(this.isEnabled()){var e=n.apply(null,arguments);console.log(a(t)+e)}}},s=function(e){if(e in o)return o[e];var t=new u(e);return o[e]=t,t};return u.ofName=s,u.isGloballyEnabled=e,u.setIsGloballyEnabled=t,u}();n.globalLogger=n.ofName("View"),e.View.Logger=n}(window),function(ctx,name){var globalLogger=ctx.View.Logger.globalLogger,setDftValue=function(e,t,n){arguments.length<3&&(n=!1),e=e||{},t=t||{};for(var i in t)i in e&&!(i in e&&null==e[i]&&n)||(e[i]=t[i]);return e},defineReadOnlyProperty=function(e,t,n){Object.defineProperty(e,t,{value:n,configurable:!1,writable:!1,enumerable:!0})},try2Apply=function(e,t,n){if(null!=e&&"function"==typeof e)try{e.apply(t,n)}catch(t){var i=t instanceof Error||null!=t&&"object"==typeof t&&"stack"in t,r="Error occured while executing function: {}. {}"+(i?" stack:\n{}":"");globalLogger.error(r,e.name,t,i?t.stack:null)}},try2Call=function(func,ctx,args){if(null!=func&&"function"==typeof func)try{var len=arguments.length;if(1===len)return func();if(2===len)return func.call(ctx);if(3===len)return func.call(ctx,arguments[2]);if(4===len)return func.call(ctx,arguments[2],arguments[3]);if(5===len)return func.call(ctx,arguments[2],arguments[3],arguments[4]);if(6===len)return func.call(ctx,arguments[2],arguments[3],arguments[4],arguments[5]);if(7===len)return func.call(ctx,arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]);for(var tmp="",index=2,i=2;i<arguments.length;i++)tmp+=",arguments["+i+"]";var rst;return void eval("rst = func.call(ctx"+tmp+")")}catch(e){return void console.error("Error occured while executing function: "+func.name,e,e.stack)}},isEmptyString=function(e,t){return arguments.length<2&&(t=!1),null===e||void 0===e||(e=String(e),t&&(e=e.trim()),0===e.length)},isNullOrUndefined=function(e){return null===e||void 0===e},ifStringEquals=function(e,t,n,i){return arguments.length<4&&(i=!0),arguments.length<3&&(n=!0),isNullOrUndefined(e)?!!isNullOrUndefined(t):!isNullOrUndefined(t)&&(i&&(e=String(e).trim(),t=String(t).trim()),n||(e=e.toLowerCase(),t=t.toLowerCase()),e===t)},ifStringEqualsIgnoreCase=function(e,t,n){return arguments.length<3&&(n=!0),ifStringEquals(e,t,!1,n)},randomString=function(){var e="0123456789abcdefghijklmnopqrstuvwxyz";return function(t){arguments.length<1&&(t="");for(var n=10,i="";n-- >0;){var r=Math.floor(Math.random()*e.length);i+=e.charAt(r)}return t+i}}(),xEncodeURIComponent=function(e){return encodeURIComponent(String(e)).replace(/\+/gm,"%2B")},getUniqueString=function(){var e=0;return function(){var t=Date.now(),n=t.toString(36),i="00"+(e++).toString(36);return i=i.substring(i.length-2),(n+i).toUpperCase()}}(),getComputedStyle=function(e){return window.getComputedStyle?window.getComputedStyle(e):e.currentStyle},env=function(){var e=navigator.userAgent,t=/(?:MQQBrowser|QQ)/.test(e),n=/(?:UCWEB|UCBrowser)/.test(e),i=/(?:Safari)/.test(e),r=/(?:Opera Mini)/.test(e),a=/(?:Mac OS)/.test(e),o=/(?:Android)/.test(e),u=/(?:Windows Phone)/.test(e),s=a&&/(?:iPad)/.test(e),l=a&&/(?:iPhone)/.test(e),c=/(?:Tablet|PlayBook)/.test(e)||s,f=/(?:Mobile)/.test(e)&&!s||u,d=!f&&!c,g={},w=function(){g.isQB=t,g.isUC=n,g.isSafari=i,g.isOpera=r,g.isIOS=a,g.isAndroid=o,g.isWindowsPhone=u,g.isIPad=s,g.isIPhone=l,g.isTablet=c,g.isMobile=f,g.isPc=d,g.isHistoryPushPopSupported="pushState"in history&&"function"==typeof history.pushState},h=function(){return e=navigator.userAgent,t=/(?:MQQBrowser|QQ)/.test(e),n=/(?:UCWEB|UCBrowser)/.test(e),i=/(?:Safari)/.test(e),r=/(?:Opera Mini)/.test(e),a=/(?:Mac OS)/.test(e),o=/(?:Android)/.test(e),u=/(?:Windows Phone)/.test(e),s=a&&/(?:iPad)/.test(e),l=a&&/(?:iPhone)/.test(e),c=/(?:Tablet|PlayBook)/.test(e)||s,f=/(?:Mobile)/.test(e)&&!s||u,d=!f&&!c,w(),g};return g.refresh=h,h(),g}(),parseParams=function(e){if(isEmptyString(e,!0))return null;var t=null,n=e.split(/\s*&\s*/);return 0!==n.length&&(t={},n.forEach(function(e){var n=e.split(/\s*=\s*/);t[decodeURIComponent(n[0])]=decodeURIComponent(n[1])})),t};ctx.View.util={setDftValue:setDftValue,defineReadOnlyProperty:defineReadOnlyProperty,try2Apply:try2Apply,try2Call:try2Call,isEmptyString:isEmptyString,isNullOrUndefined:isNullOrUndefined,ifStringEquals:ifStringEquals,ifStringEqualsIgnoreCase:ifStringEqualsIgnoreCase,randomString:randomString,xEncodeURIComponent:xEncodeURIComponent,getUniqueString:getUniqueString,getComputedStyle:getComputedStyle,parseParams:parseParams,env:env}}(window,"View"),function(e,t){var n=e.View.util,i=e.View.Logger,r=i.globalLogger,a=function(){var e=[],t=function(){var t;return function(i){clearTimeout(t),t=setTimeout(function(){for(var t=0;t<e.length;t++)n.try2Call(e[t],null,i)},20)}}(),i=function(){var e=document.documentElement;return e.clientWidth<=e.clientHeight},a=function(){var e=document.documentElement;return e.clientWidth>e.clientHeight},o=function(){var e=!1,n=-1,r=i(),a=function(){e=!0,n=Date.now()},u=function(){e=!1,n=-1},s=function(e){r==i()?setTimeout(o,20):(u(),r=i(),t(e))};return u(),function(t){if(e){Date.now()-n<500?s(t):u()}else a(),s(t)}}(),u=function(){var e,n=0,i=0,r=function(){n=0,i=0},a=function(){clearTimeout(e),e=setTimeout(t,20)},o=function(){var e=window.innerWidth,t=window.innerHeight,r=Math.abs(e-n);(0==n||r<.01&&t>i)&&(n=e,i=t,a()),n=e,i=t};return o.reset=r,o.try2ExecChangeCallbacks=a,o}();!function(){var e,i=null,a=function(){u.reset(),clearInterval(e),e=null},s=function(){a(),e=setInterval(u,50)};return function(){setInterval(function(){n.env.refresh(),n.env.isPc?("pc"!=i&&(r.debug("Page viewing mode is PC mode."),a(),window.removeEventListener("orientationchange",o),t(),window.addEventListener("resize",t)),i="pc"):("!pc"!=i&&(r.debug("Page viewing mode is none-PC mode."),window.removeEventListener("resize",t),t(),window.addEventListener("orientationchange",o),s()),i="!pc")},30)}}()();var s=function(t){e.indexOf(t)==-1&&e.push(t)},l={isPortrait:i,isLandscape:a,addChangeListener:s};return Object.freeze&&Object.freeze(l),l}();e.View.resolution=a}(window),function(e,t){var n=e.View.util,i=e.View.resolution,r=function(){var e=320/568,t=!0,r=[],a={},o=document.documentElement,u=function(){return o.querySelector("[data-view-container]")||document.body},s=function(){var e=u(),t=n.getComputedStyle(e),i=Number(t.paddingLeft.replace(/px/,"")),r=Number(t.paddingRight.replace(/px/,""));return isNaN(i)&&(i=0),isNaN(r)&&(r=0),e.clientWidth-i-r},l=function(){var e=u(),t=n.getComputedStyle(e),i=Number(t.paddingTop.replace(/px/,"")),r=Number(t.paddingBottom.replace(/px/,""));return isNaN(i)&&(i=0),isNaN(r)&&(r=0),e.clientHeight-i-r},c=function(){return window.innerWidth||o.clientWidth},f=function(){return window.innerHeight||o.clientHeight},d=function(){return s()<=l()},g=function(){return!isPortrait()},w=function(){return c()<=f()},h=function(){return!w()},p=function(){return c()/f()},v=function(){return c()/f()},m=function(){return e},y=function(t){return e=t,a},V=function(e,t){var n=this,i=n.style;i.width=e+"px",i.height=t+"px"},S=V,E=S,b=E,I=S,P=I,A=b,C=A,O=S,N=O,L=b,_=L,T=function(){var e=c(),t=f(),i=h()?b:S;n.try2Call(i,u(),e,t)},D=function(){var e=c(),t=f(),i=h()?C:P;n.try2Call(i,u(),e,t)},W=function(){var t=c(),i=f();w()?n.try2Call(N,u(),t,i):_===L?(t=i*e,n.try2Call(S,u(),t,i)):n.try2Call(_,u(),t,i)},R=function(e){if(r.indexOf(e)===-1)return r.push(e),a},x=function(e){var t=r.indexOf(e);if(t!==-1)return r.splice(t,1),a},H=function(){var e=s(),t=l();return function(i){arguments.length<1&&(i=!0),n.env.isPc?W():n.env.isTablet?D():T();var o=s(),u=l(),d=c(),g=f();if(Math.abs(e-o)>=.1||Math.abs(t-u)>=.1){var w=function(){for(var e=0;e<r.length;e++){var t=r[e];"function"==typeof t&&n.try2Call(t,null,o,u,d,g)}};i?setTimeout(w,0):w()}return a}}(),F=function(e){return e=n.setDftValue(e,{autoReLayoutWhenResize:!0,layoutAsMobilePortrait:S,layoutAsMobileLandscape:b,layoutAsTabletLandscape:C,layoutAsTabletPortrait:P,layoutAsPcPortrait:N,layoutAsPcLandscape:_}),t=!!e.autoReLayoutWhenResize,t&&i.addChangeListener(H),"function"==typeof e.layoutAsMobilePortrait&&(S=e.layoutAsMobilePortrait),"function"==typeof e.layoutAsMobileLandscape&&(b=e.layoutAsMobileLandscape),"function"==typeof e.layoutAsTabletPortrait&&(P=e.layoutAsTabletPortrait),"function"==typeof e.layoutAsTabletLandscape&&(C=e.layoutAsTabletLandscape),"function"==typeof e.layoutAsPcPortrait&&(N=e.layoutAsPcPortrait),"function"==typeof e.layoutAsPcLandscape&&(_=e.layoutAsPcLandscape),a};return(0,n.setDftValue)(a,{getLayoutWidth:s,getLayoutHeight:l,getBrowserWidth:c,getBrowserHeight:f,isLayoutPortrait:d,isLayoutLandscape:g,isBrowserPortrait:w,isBrowserLandscape:h,getLayoutWidthHeightRatio:p,getBrowserWidthHeightRatio:v,getExpectedWidthHeightRatio:m,setExpectedWidthHeightRatio:y,init:F,doLayout:H,addLayoutChangeListener:R,removeLayoutChangeListener:x}),Object.freeze&&Object.freeze(a),a}();e.View.layout=r}(window),function(e,t){var n=e.View.util,i=function(){var e=/mobile|tablet|ip(ad|hone|od)|android/i,t=(window,e.test(navigator.userAgent)),i="  __com.soft.plugin.touch#"+(new Date).getTime()+"__  ",r=function(e,t){return e=e||{},e[t]=e[t]||{},e[t]};return{addTapListener:function(e,a,o){if(!t)return void(e.addEventListener?e.addEventListener("click",a):e.attachEvent("onclick",a));var u=r(e,i+".tap");if(u.callbacks=u.callbacks||[],u.callbacks.indexOf(a)==-1){u.callbacks.push(a),o=n.setDftValue(o,{timespan:500,delta:{},useCapture:!1}),o.delta=n.setDftValue(o.delta,{x:10,y:15});var s=r(e,i+".tap.meta");null==s.touchstart&&(s.touchstart=function(e){var t=e.changedTouches?e.changedTouches[0]:e;u.startX=t.screenX,u.startY=t.screenY,u.startTimestamp=Date.now()},e.addEventListener("touchstart",s.touchstart)),null==s.touchend&&(s.touchend=function(t){var i=t.changedTouches?t.changedTouches[0]:t;u.stopX=i.screenX,u.stopY=i.screenY,u.stopTimestamp=Date.now();var r=u.stopTimestamp-u.startTimestamp,a=Math.abs(u.stopX-u.startX),s=Math.abs(u.stopY-u.startY);if(r<=o.timespan&&a<=o.delta.x&&s<=o.delta.y)for(var l=0;l<u.callbacks.length;l++)n.try2Call(u.callbacks[l],e,t)},e.addEventListener("touchend",s.touchend,o.useCapture))}},removeTapListener:function(e,n,a){if(!t)return void(e.removeEventListener?e.removeEventListener("click",n):e.detachEvent("onclick",n));if(e.hasOwnProperty(i)){var o=r(e,i+".tap"),u=o.callbacks.indexOf(n);if(u!=-1&&(o.callbacks.splice(u,1),0==o.callbacks.length)){var s=r(e,i+".tap.meta");e.removeEventListener("touchstart",s.touchstart),e.removeEventListener("touchend",s.touchend,a),delete e[i].tap}}}}}();e.View.touch=i}(window),function(e,t){var n=e.View.util,i=function(){var e={};n.defineReadOnlyProperty(this,"has",function(t){return t in e}),n.defineReadOnlyProperty(this,"set",function(t,n){return e[t]=n,this}),n.defineReadOnlyProperty(this,"get",function(t){return e[t]}),n.defineReadOnlyProperty(this,"remove",function(t){var n=e[t];return delete e[t],n}),n.defineReadOnlyProperty(this,"clear",function(){return e={},this})};e.View.ViewContext=i}(window),function(e,t){var n=e.View.Logger.globalLogger,i={},r=function(e,t,r){var a,o=e,u=i;this.getName=function(){return o},this.getValue=function(e){if(i==u){if(arguments.length<1)return;return e}return u},this.setValue=function(e,t){return arguments.length<2&&(t=!1),(t||i==u)&&(u=e),this},this.getApplication=function(){return a},this.setApplication=function(e){return"function"!=typeof e?(n.warn("Configuration application should be of type: 'Function'."),this):(a=e,this)},this.apply=function(){if("function"==typeof a)try{a.call(this,u)}catch(i){n.error("Fail to apply configuration: {} = {} for view of id: '{}' namespace: '{}'\n{}",e,String(u),t,r,i),i instanceof Error?console.error(i,i.stack):console.error(i)}return this},this.reflectToDom=function(){return null==t||""==t.trim()?this:View.ifExists(t,r)?(View.ofId(t,r).getDomElement().setAttribute("data-viewconfig_"+this.getName(),String(this.getValue())),this):(n.warn("No view of id '{}' namespace: '{}' found to reflect view config: {}={}.",t,r,this.getName(),this.getValue()),this)},Object.freeze(this)};e.View.ViewConfiguration=r}(window),function(e,t){var n=e.View.util,i=e.View.ViewConfiguration,r=function(e,t){var r={};this.has=function(e){return e in r},this.get=function(n){var a;return n in r?a=r[n]:(a=new i(n,e,t),r[n]=a),a},this.applyAll=function(){var e=Object.keys(r).map(function(e){return r[e]});if(0!=e.length)return setTimeout(function(){for(var t=0;t<e.length;t++){var i=e[t];n.try2Call(i.apply,i)}},0),this},this.listAll=function(){return Object.keys(r)}};e.View.ViewConfigurationSet=r}(window),function(e,t){var n=e.View.util,i=e.View.layout,r=e.View.Logger.globalLogger,a=document.documentElement,o={},u=function(){var e={},t=-1,u=-1,s=0,l=0,c=function(e,c){var f=function(){},d=!0,g=50,w=o;n.defineReadOnlyProperty(this,"setLayoutAction",function(t){return"function"!=typeof t?(r.error("Layout action for view of id: '{}' namespace: '{}' should be of type: Function.",e,c),this):(f!=t&&(w=o,f=t),this)}),n.defineReadOnlyProperty(this,"getLayoutAction",function(){return f}),n.defineReadOnlyProperty(this,"doLayout",function(){return"function"!=typeof f?this:((Math.abs(s-t)>.05||Math.abs(l-u)>.05)&&(a.offsetWidth=a.offsetHeight),f(),t=s,u=l,this)}),n.defineReadOnlyProperty(this,"setLayoutCushionTime",function(e){return null==e||isNaN(e=Number(e))||e<0?(r.error("Invalid layout cushion time. Should be a digit greater than or equal to 0."),this):(g=e,this)}),n.defineReadOnlyProperty(this,"getLayoutCushionTime",function(e){return g}),n.defineReadOnlyProperty(this,"setIfLayoutWhenLayoutChanges",function(e){return d=e,this});var h,p=this;i.addLayoutChangeListener(function(t,n){d&&View.ofId(e,c).isActive()&&(r.debug("Layout changes, doing layout for view of id: '{}' namespace: '{}'. Width: {}, height: {}",e,c,t,n),s=t,l=n,clearTimeout(h),g>0?h=setTimeout(function(){p.doLayout()},g):p.doLayout())})};return c.ofId=function(t,n){var i=t+"@"+n;if(i in e)return e[i];var r=new c(t,n);return e[i]=r,r},c.implIsPortrait=function(e){return r.warn("This method is redundant and deprecated and will be removed in the future."),c},c}();e.View.ViewLayout=u}(window),function(e,t){var n=e.View.util,i=e.View.Logger.globalLogger,r=n.randomString("ViewState_"),a=function(e,t,i){var r=n.isEmptyString(t,!0)||"default"===t?"":"@"+String(t),a=String(e)+r,o=null==i?[]:Object.keys(i),u=o.reduce(function(e,t){return e+"&"+n.xEncodeURIComponent(t)+"="+n.xEncodeURIComponent(i[t])},"");return u.length>0&&(a+="!"+u.substring(1)),a},o=function(e,t,i,a){arguments.length<3&&(a=null),arguments.length<2&&(i=n.getUniqueString()),i=i||n.getUniqueString(),n.defineReadOnlyProperty(this,"viewId",e),n.defineReadOnlyProperty(this,"viewNamespace",t),n.defineReadOnlyProperty(this,"sn",i),n.defineReadOnlyProperty(this,"options",a),n.defineReadOnlyProperty(this,"flag",r),this.toString=function(){return JSON.stringify(this)},this.clone=function(){return JSON.parse(this.toString())}};o.isConstructorOf=function(e){return null!=e&&"object"==typeof e&&(e.hasOwnProperty("viewId")&&e.hasOwnProperty("sn")&&String(e.flag).startsWith("ViewState_"))},o.pushViewState=function(e,t,r,u){arguments.length<4&&(u=null),arguments.length<3&&(r=n.getUniqueString()),(arguments.length<2||n.isEmptyString(t,!0))&&(t="default"),r=r||n.getUniqueString();var s=new o(e,t,r,u).clone();i.log("↓ {}",JSON.stringify(s)),n.env.isHistoryPushPopSupported?history.pushState(s,"","#"+a(e,t,u)):location.hash=a(e,t,u),View.currentState=s},o.replaceViewState=function(e,t,r,u){arguments.length<4&&(u=null),arguments.length<3&&(r=n.getUniqueString()),(arguments.length<2||n.isEmptyString(t,!0))&&(t="default"),r=r||n.getUniqueString();var s=new o(e,t,r,u).clone();i.log("% {}",JSON.stringify(s)),n.env.isHistoryPushPopSupported?history.replaceState(s,"","#"+a(e,t,u)):location.hash=a(e,t,u),View.currentState=s},e.View.ViewState=o}(window),function(e,t){var n=e.View.util,i=function(){var e=n.randomString("OperationState_"),t=function(t,i){arguments.length<2&&(timeBasedUniqueString=n.getUniqueString()),timeBasedUniqueString=timeBasedUniqueString||n.getUniqueString(),n.defineReadOnlyProperty(this,"serialNumber",t),n.defineReadOnlyProperty(this,"sn",timeBasedUniqueString),n.defineReadOnlyProperty(this,"flag",e),this.toString=function(){return JSON.stringify(this)},this.clone=function(){return JSON.parse(this.toString())}};t.isConstructorOf=function(e){return null!=e&&"object"==typeof e&&(e.hasOwnProperty("serialNumber")&&e.hasOwnProperty("sn")&&String(e.flag).startsWith("OperationState_"))};var r=null,a={};return t.pushState=function(e,t){var n=new i(e).clone();history.pushState(n,"",""),r=n,a[e]=t},window.addEventListener("popstate",function(e){if(t.isConstructorOf(r)){var i=e.state&&e.state.sn&&e.state.sn<r.sn,o=a[r.serialNumber];i&&null!=o&&(n.try2Call(o),delete a[r.serialNumber])}var u=e.state;r=t.isConstructorOf(u)?u:null}),t}();e.View.OperationState=i}(window),function(e,t){var n=e.View.util,i=e.View.Logger,r=e.View.eventDrive,a=(i.globalLogger,{}),o=n.randomString("__ViewWantedDataListenFlag__"),u=(n.randomString("_@sep@_"),{}),s=function(e){var t=a;r(this,this);var i=this;this.want=function(e,i){return this.isFulfilled()?n.try2Call(e,null,t,{dataResolveMethod:"provideExisting"}):n.try2Call(i),this},this.listen=function(e){return this.isFulfilled()&&n.try2Call(e,null,t),"function"!=typeof e[o]&&(e[o]=function(t){n.try2Call(e,null,t.data)}),i.on("fulfilled",e[o]),this},this.fulfill=function(e){return t=e,this.fire("fulfilled",e),this},this.isFulfilled=function(){return a!==t}},l=function(e,t){var n=e+"@"+t;if(n in u)throw new Error("Instance for view of id: '"+e+"' namespace: '"+t+"' exists already.");var i={};this.ofName=function(e){return e in i?i[e]:(i[e]=new s(e),i[e])},this.want=function(e,t,n){return this.ofName(e).want(t,n)},this.listen=function(e,t){return this.ofName(e).listen(t)},this.fulfill=function(e,t){return this.ofName(e).fulfill(t)},this.isFulfilled=function(e){return this.ofName(e).isFulfilled()},u[n]=this};l.ofName=function(e,t,n){var i=e+"@"+t;return i in u?u[i].ofName(n):(u[i]=new l(e,t)).ofName(n)},e.View.ViewWantedData=l}(window),function(e,t){e.View.viewAttribute={attr$view:"data-view",attr$viewId:"data-view-id",attr$view_namespace:"data-view-namespace",attr$view_default:"data-view-default",attr$view_directly_accessible:"data-view-directly-accessible",attr$view_group:"data-view-group",attr$view_fallback:"data-view-fallback",attr$view_rel:"data-view-rel",attr$view_rel_disabled:"data-view-rel-disabled",attr$view_rel_type:"data-view-rel-type",attr$view_rel_namespace:"data-view-rel-namespace",attr$view_title:"data-view-title",attr$view_container:"data-view-container",attr$view_os:"data-view-os",attr$view_whr:"data-view-whr"}}(window),function(e,t){var n=(e.View.Logger.globalLogger,e.View.util),i=function(e){return":back"===e||":forward"===e||":default-view"===e},r=function(e){if(""===e)return null;var t=e.match(/^#([\w$\-]+)(?:@([^!]+))?(?:!+(.*))?/);if(null==t)return null;var i=t[1],r=t[2],a=n.parseParams(t[3]);return n.isEmptyString(r,!0)&&(r="default"),{viewId:i,viewNamespace:r,options:a}};e.View.viewRepresentation={PSVIEW_BACK:":back",PSVIEW_FORWARD:":forward",PSVIEW_DEFAULT:":default-view",isPseudoView:i,parseViewInfoFromHash:r}}(window),function(e,t){var n=(e.View.Logger.globalLogger,e.View.viewRepresentation),i={},r=function(e,t){return e+"@"+t in i},a=function(e,t){return i[e+"@"+t]},o=function(e,t,n){i[e+"@"+t]=n},u=function(e,t){delete i[e+"@"+t]},s=function(e,t,i){if(!View.ifExists(e,t)&&!n.isPseudoView(e))throw new Error("View of id: '"+e+"' within namespace: '"+t+"' does not exist.");if(void 0===i&&(i=null),"object"!=typeof i)throw new Error("Parameters specified should be an object or null.");return o(e,t,i),View},l=function(e,t){return delete i[e+"@"+t],View};e.View.viewParameter={hasParameters:r,getParameters:a,setParameters:o,removeParameters:u,setViewParameters:s,clearViewParameters:l}}(window),function(e,t){var n=e[t].Logger.globalLogger,i=e[t].util,r=e[t].ViewLayout,a=e[t].viewParameter,o=e[t].viewRepresentation,u=e[t].viewAttribute,s={},l=[],c=null,f=function(e){e in s||(s[e]=[])},d=function(e){if(!(e instanceof HTMLElement))return null;var t=e.getAttribute(u.attr$viewId);return i.isEmptyString(t,!0)&&(t=e.id),t},g=function(e){if(!(e instanceof HTMLElement))return!1;var t=e.getAttribute(u.attr$view);return null!=t&&("true"===(t=t.toLowerCase())&&!i.isEmptyString(d(e),!0))},w=function(){for(var e=document.querySelectorAll("*["+u.attr$view+"=true]"),t=[],n=0;n<e.length;n++)g(e[n])&&t.push(e[n]);return t},h=function(e,t){(arguments.length<2||i.isEmptyString(t,!0))&&(t="default"),f(t);var n=document.querySelectorAll("["+u.attr$view+"=true]");if(0===n.length)return null;for(var r=null,a=0;a<n.length;a++){var o=n[a],s=d(o),l=o.getAttribute(u.attr$view_namespace);if(i.isEmptyString(l,!0)&&(l="default"),e==s&&l===t){r=o;break}}return r},p=function(){return null==View.currentState?null:View.currentState.viewId},v=function(){var e=View.getActiveView();return null==e&&(e=View.getDefaultView()),e},m=function(e,t){(arguments.length<2||"string"!=typeof t||i.isEmptyString(t,!0))&&(t="default"),f(t);var n=null;return i.isEmptyString(e,!0)||!View.ifExists(e,t)?n=v():(n=View.ofId(e,t),n.isDirectlyAccessible()||(n=n.getFallbackView())),n},y=function(e){arguments.length>1&&(e=String(e).toLowerCase());var t=[];for(var n in s)t=t.concat(s[n]);return arguments.length<1||i.isEmptyString(e,!0)?t:t.filter(function(t){return e===t.getGroupName()})},V=function(e){if(i.isEmptyString(e,!0))return n.error("Empty view group name!"),null;e=String(e).trim().toLowerCase();var t=y(e);if(null==t||0===t.length)return n.error("No view of group: {} found.",e),null;var r=t.map(function(e){return e.getId()}),a=r[0];return n.info("Found {} views of group: {}: {}, using the first one: {}.",r.length,e,r,a),a},S=function(e){i.isEmptyString(e,!0)&&(e=View.SWITCHTYPE_VIEWNAV);var t=i.ifStringEqualsIgnoreCase(e,View.SWITCHTYPE_VIEWNAV),n=i.ifStringEqualsIgnoreCase(e,View.SWITCHTYPE_VIEWCHANGE),r=i.ifStringEqualsIgnoreCase(e,View.SWITCHTYPE_HISTORYBACK),a=i.ifStringEqualsIgnoreCase(e,View.SWITCHTYPE_HISTORYFORWARD);return r||a||t||n||(e=View.SWITCHTYPE_VIEWNAV),e},E=function(e){e=i.setDftValue(e,{srcView:null,targetView:null,type:View.SWITCHTYPE_VIEWNAV,withAnimation:!0,params:null});var t=e.srcView,u=e.targetView,s=S(e.type),f=e.params,d=i.ifStringEqualsIgnoreCase(s,View.SWITCHTYPE_HISTORYBACK),g=i.ifStringEqualsIgnoreCase(s,View.SWITCHTYPE_HISTORYFORWARD),w={currentView:t,targetView:u,type:s,params:f},h=function(){var e=u.getId(),i=u.getNamespace();a.clearViewParameters(e,i),d?a.hasParameters(o.PSVIEW_BACK,"")&&(a.setViewParameters(e,i,a.getParameters(o.PSVIEW_BACK,"")),a.clearViewParameters(o.PSVIEW_BACK,"")):g?a.hasParameters(o.PSVIEW_FORWARD,"")&&(a.setViewParameters(e,i,a.getParameters(o.PSVIEW_FORWARD,"")),a.clearViewParameters(o.PSVIEW_FORWARD,"")):a.setViewParameters(e,i,f);var c={sourceView:t,type:s,params:f},h=function(e,t){try{u.fire(e,c,t)}catch(t){n.error("Error occurred while firing event: {} with data: {}",e,c),t instanceof Error?console.error(t,t.stack):console.error(t)}};t&&t.getDomElement().classList.remove("active"),t&&t.fire("leave",{targetView:u,type:s}),h("beforeenter",!1),u.getDomElement().classList.add("active"),r.ofId(e,i).doLayout(),View.fire("change",w,!1),u.isReady()||(l.push(e),h("ready",!1)),h("enter",!1),h("afterenter",!1),View.fire("afterchange",w)};View.fire("beforechange",w,!1),e.withAnimation&&c?c.call(null,t?t.getDomElement():null,u.getDomElement(),s,h):h()},b=function(e,t,r){if((arguments.length<2||"string"!=typeof t||i.isEmptyString(t,!0))&&(t="default"),f(t),r=i.setDftValue(r,{},!0),!View.ifExists(e,t))throw n.log("Trying to navigate to view: '{}' within namespace: '{}' with params: {}, options: {}",e,t,r.params,r.options),new Error("Target view: '"+e+"' within namespace: '"+t+"' does not exist!");var a=View.getActiveView();n.log("{}@{} → {}@{} {}",a?a.getId():null,a?a.getNamespace():null,e,t,JSON.stringify(r));var o=View.ofId(e,t);return r.srcView=a,r.targetView=o,E(r),View};e[t].viewInternalVariable={defaultNamespace:"default",defaultWidthHeightRatio:"320/568",viewInstancesMap:s,readyViews:l,get viewSwitchAnimation(){return c},set viewSwitchAnimation(e){c=e},getPotentialViewId:d,getViewDomElements:w,getViewDomElementOfId:h,getRenderingViewId:p,buildNamespace:f,getFinalView:m,listAllViews:y,findFirstViewIdOfGroupName:V,switchView:E,showView:b}}(window,"View"),function(e,t){var n=e[t].util,i=e[t].eventDrive,r=e[t].Logger,a=e[t].ViewConfigurationSet,o=e[t].ViewContext,u=e[t].ViewLayout,s=e[t].ViewWantedData,l=e[t].viewRepresentation,c=e[t].viewParameter,f=e[t].viewAttribute,d=e[t].viewInternalVariable,g=r.globalLogger,w=function(e,t){(arguments.length<2||n.isEmptyString(t,!0))&&(t=d.defaultNamespace);var h=null,p=document.querySelectorAll("["+f.attr$view+"=true]");if(0===p.length||function(){for(var i=0;i<p.length;i++){var r=p[i],a=d.getPotentialViewId(r),o=r.getAttribute(f.attr$view_namespace);if(n.isEmptyString(o,!0)&&(o=d.defaultNamespace),e===a&&o===t){h=r;break}}return null==h}())throw new Error("View of id: '"+e+"' within namespace: '"+t+"' does not exist!");var v={},m=new o,y=new a(e,t),V=new s(e,t);i(this,h);var S=this.fire;this.fire=function(e,t,n){v[e]=t,S(e,t,n)},n.defineReadOnlyProperty(this,"id",e),n.defineReadOnlyProperty(this,"namespace",t),n.defineReadOnlyProperty(this,"logger",r.ofName("View#"+e)),n.defineReadOnlyProperty(this,"config",y),n.defineReadOnlyProperty(this,"context",m),this.getLatestEventData=function(e){return v[e]},this.getContext=function(){return m},this.clearContext=function(){return m.clear(),this},this.getId=function(){return e},this.getNamespace=function(){return t},this.getDomElement=function(){return h},this.getGroupName=function(){var e=this.getDomElement().getAttribute(f.attr$view_group);if(null==e)return e;e=String(e).toLowerCase()},this.find=function(e){return this.getDomElement().querySelector(e)},this.findAll=function(e){return this.getDomElement().querySelectorAll(e)},this.fulfillWantedData=function(e,t){var i=e+":fulFillCallback",r=this.getParameter(i);return"function"==typeof r&&(g.info("Found auto attached(by 'View.want()' method) fulfill listener(parameter name: '{}'), auto execute this listener with fulfilled data.",i),n.try2Call(r,null,t,{dataResolveMethod:"resolveLater"})),V.fulfill(e,t),this},this.isWantedDataFulfilled=function(e){return V.isFulfilled(e)},this.setLayoutAction=function(n,i){return arguments.length<2&&(i=!0),u.ofId(e,t).setIfLayoutWhenLayoutChanges(!!i).setLayoutAction(n),this},this.getLayoutAction=function(){return u.ofId(e,t).getLayoutAction()},this.hasParameter=function(e){if(null===e||void 0===e)return!1;var t=c.getParameters(this.getId(),this.getNamespace());return null!=t&&e in t},this.getParameter=function(e){var t=c.getParameters(this.getId(),this.getNamespace());return arguments.length<1?t:null==t?null:t[e]},this.seekParameter=function(e){if(this.hasParameter(e))return this.getParameter(e);if(w.hasActiveViewOption(e))return w.getActiveViewOption(e);var t=new RegExp("\\b"+e+"\\b=([^&\\?]*)"),n=location.search.match(t);return null==n?null:n=decodeURIComponent(n[1])},this.isReady=function(){return d.readyViews.indexOf(this.getId())!==-1},this.isActive=function(){return this.getDomElement().classList.contains("active")},this.isDefault=function(){return/true/i.test(this.getDomElement().getAttribute(f.attr$view_default))},this.isDirectlyAccessible=function(){var e=this.getDomElement().getAttribute(f.attr$view_directly_accessible);return e=null==e?null:e.toLowerCase(),w.isDirectlyAccessible()?"false"!==e:"true"===e},this.setAsDirectlyAccessible=function(e){return arguments.lengt<1&&(e=!0),this.getDomElement().setAttribute(f.attr$view_directly_accessible,String(e)),this},this.setTitle=function(e){return null==e?(this.getDomElement().removeAttribute(f.attr$view_title),this):(e=String(e),this.getDomElement().setAttribute(f.attr$view_title,e),this.isActive()&&(document.title=e),this)},this.getTitle=function(e){return this.getDomElement().getAttribute(f.attr$view_title)},this.setFallbackViewId=function(e){if(n.isEmptyString(e,!0))return this;if(n.ifStringEqualsIgnoreCase(l.PSVIEW_DEFAULT,e)){var t=w.getDefaultView();if(null==t)return g.error("No default view found."),this;e=t.getId()}else if(/^~/.test(e)){var i=e.substring(1),r=d.findFirstViewIdOfGroupName(i);if(null==r)return g.warn("No view of group: {} found.",i),this;e=r}return w.ifExists(e)?this.getId()===e?this:(this.getDomElement().setAttribute(f.attr$view_fallback,e),this):(g.warn("No view of id: {} found.",e),this)},this.getFallbackView=function(){for(var e=this,t=[this.getId()];;){var i=e.getDomElement().getAttribute(f.attr$view_fallback);if(n.ifStringEqualsIgnoreCase(l.PSVIEW_DEFAULT,i))return w.getDefaultView();if(/^~/.test(i)){var r=i.substring(1),a=d.findFirstViewIdOfGroupName(r);if(null==a)return w.getDefaultView();i=a}if(null==i||!w.ifExists(i))return g.warn("View: "+e.getId()+" is not permited to access directly, and no fallback configuration found, thus returning the default view"),w.getDefaultView();if(e=w.ofId(i),t.indexOf(e.getId())!==-1)return g.error("Cyclical reference of view on fallback configuration on view: {}. Chain: {}, view id: {}",this.getId(),t,e.getId()),w.getDefaultView()
	;if(e.isDirectlyAccessible())return e;t.push(i)}},Object.freeze&&Object.freeze(this)};i(w),n.defineReadOnlyProperty(w,"SWITCHTYPE_HISTORYFORWARD","history.forward"),n.defineReadOnlyProperty(w,"SWITCHTYPE_HISTORYBACK","history.back"),n.defineReadOnlyProperty(w,"SWITCHTYPE_VIEWNAV","view.nav"),n.defineReadOnlyProperty(w,"SWITCHTYPE_VIEWCHANGE","view.change"),e[t].ViewConstructor=w}(window,"View"),function(e,t){var n=e[t].util,i=e[t].Logger,r=e[t].touch,a=e[t].layout,o=e[t].ViewConstructor,u=e[t].ViewState,s=e[t].OperationState,l=(e[t].ViewLayout,e[t].ViewWantedData),c=e[t].viewRepresentation,f=e[t].viewParameter,d=e[t].viewAttribute,g=e[t].viewInternalVariable,w=i.globalLogger;o.currentState=null,o.Logger=i,o.layout=a,o.checkIfBrowserHistorySupportsPushPopAction=function(){return n.env.isHistoryPushPopSupported},o.getViewContainerDomElement=function(){var e=document.querySelector("["+d.attr$view_container+"]");return null==e&&(e=document.body),e},o.find=function(e,t){return 1===arguments.length&&(t=arguments[0],e=o.getViewContainerDomElement()),e.querySelector(t)},o.findAll=function(e,t){return 1===arguments.length&&(t=arguments[0],e=o.getViewContainerDomElement()),e.querySelectorAll(t)},o.ofId=function(e,t){(arguments.length<2||n.isEmptyString(t,!0))&&(t=g.defaultNamespace),g.buildNamespace(t);for(var i=g.viewInstancesMap[t],r=0;r<i.length;r++)if(i[r].getId().trim()===e.trim()&&i[r].getNamespace().trim()===t.trim())return i[r];var a=new o(e,t);return i.push(a),a},o.ifExists=function(e,t){(arguments.length<2||n.isEmptyString(t,!0))&&(t=g.defaultNamespace),g.buildNamespace(t);for(var i=g.viewInstancesMap[t],r=0;r<i.length;r++)if(i[r].getId().trim()===e.trim())return!0;return!1},o.listAll=g.listAllViews,o.listAllGroups=function(){return g.listAllViews().reduce(function(e,t){var i=t.getGroupName();return n.isEmptyString(i,!0)||e.indexOf(i)!==-1?e:(e.push(i),e)},[])},o.setAsDefault=function(e,t){if((arguments.length<2||n.isEmptyString(t,!0))&&(t=g.defaultNamespace),g.buildNamespace(t),n.isEmptyString(e,!0))return w.warn("No view id supplied to set as default."),o;for(var i=g.getViewDomElements(),r=0;r<i.length;r++)i[r].removeAttribute(d.attr$view_default);var a=g.getViewDomElementOfId(e,t);return null==a?(w.error("No view dom element of id: '{}' namespace: '{}' found to set as default.",e,t),o):(a.setAttribute(d.attr$view_default,"true"),o)},o.isDirectlyAccessible=function(){var e=document.documentElement.getAttribute(d.attr$view_directly_accessible);return n.ifStringEqualsIgnoreCase("true",e)},o.setIsDirectlyAccessible=function(e){return document.documentElement.setAttribute(d.attr$view_directly_accessible,String(!!e).toLowerCase()),o},o.getActiveView=function(){for(var e=g.listAllViews(),t=0;t<e.length;t++)if(e[t].isActive())return e[t];return null},o.getDefaultView=function(){for(var e=g.listAllViews(),t=0;t<e.length;t++)if(e[t].isDefault())return e[t];return null},o.setSwitchAnimation=function(e){if(!(e instanceof Function))throw new Error("Invalid argument, type of 'Function' is required.");return g.viewSwitchAnimation=e,o},o.getSwitchAnimation=function(){return g.viewSwitchAnimation},o.getActiveViewOptions=function(){var e=c.parseViewInfoFromHash(location.hash);return null==e?null:e.options},o.hasActiveViewOption=function(e){var t=o.getActiveViewOptions();return null!=t&&e in t},o.getActiveViewOption=function(e){var t=o.getActiveViewOptions();return null==t?null:t[e]},o.setActiveViewOption=function(e,t){if(n.isEmptyString(e,!0))return w.error("Option name should not be empty."),o;var i=o.getActiveView();if(null==i)return w.error("No active view to set option {} = {}.",e,t),o;e=String(e).trim(),t=String(t).trim();var r=o.getActiveViewOptions()||{};return r[e]=t,u.replaceViewState(i.getId(),i.getNamespace(),o.currentState?o.currentState.sn:null,r),o},o.wantData=function(e,t,n,i,r){"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&("string"==typeof arguments[2]||(r=arguments[3],i=arguments[2],n=arguments[1],t=g.defaultNamespace));var a=l.ofName(e,t,n);if("function"!=typeof r){var u=n+":fulFillCallback";w.info("No parameter meaning 'callback for situation that wanted data is currently not fulfilled' specified, auto assign as View.navTo('{}', {params: {'{}': function(){...}}})",e,u);var s={};s[u]=i,r=function(){o.navTo(e,t,{params:s})}}return a.want(i,r),o},o.listenWantedData=function(e,t,n,i){return"string"==typeof arguments[0]&&"string"==typeof arguments[1]&&("string"==typeof arguments[2]||(i=arguments[2],n=arguments[1],t=g.defaultNamespace)),l.ofName(e,t,n).listen(i),o},o.passBy=function(e,t){if((arguments.length<2||"string"!=typeof t||n.isEmptyString(t,!0))&&(t=g.defaultNamespace),g.buildNamespace(t),n.ifStringEqualsIgnoreCase(c.PSVIEW_DEFAULT,e)){var i=o.getDefaultView();if(null==i)return w.error("No default view found."),o;e=i.getId()}if(/^~/.test(e)){var r=e.substring(1),a=g.findFirstViewIdOfGroupName(r);if(null==a)return o;e=a}return o.ifExists(e,t)?(u.pushViewState(e,t),o):(console.error(new Error("Target view: '"+e+"' within namespace: '"+t+"' does not exist!")),o)},o.navTo=function(e,t,i){(arguments.length<2||"string"!=typeof t||n.isEmptyString(t,!0))&&(i=t,t=g.defaultNamespace),g.buildNamespace(t),e=e.trim(),i=n.setDftValue(i,{});g.getRenderingViewId(),o.getActiveView();if(n.ifStringEqualsIgnoreCase(c.PSVIEW_BACK,e))return o.back(i),o;if(n.ifStringEqualsIgnoreCase(c.PSVIEW_FORWARD,e))return o.forward(i),o;if(n.ifStringEqualsIgnoreCase(c.PSVIEW_DEFAULT,e)){var r=o.getDefaultView();if(null==r)return w.error("No default view found."),o;e=r.getId()}if(/^~/.test(e)){var a=e.substring(1),s=g.findFirstViewIdOfGroupName(a);if(null==s)return o;e=s}if(!o.ifExists(e,t)){w.log("Trying to navigate to view: '{}' within namespace: '{}' with params: {}, options: {}",e,t,i.params,i.options);var l=new Error("Target view: '"+e+"' within namespace: '"+t+"' does not exist! Firing event 'viewnotexist'...");return console.error(l),o.fire("viewnotexist",{targetViewId:e,targetViewNamespace:t}),o}return i.type=o.SWITCHTYPE_VIEWNAV,u.pushViewState(e,t,null,null==i?null:i.options),g.showView(e,t,i),o},o.changeTo=function(e,t,i){(arguments.length<2||"string"!=typeof t||n.isEmptyString(t,!0))&&(i=t,t=g.defaultNamespace),g.buildNamespace(t),i=n.setDftValue(i,{});g.getRenderingViewId(),o.getActiveView();if(n.ifStringEqualsIgnoreCase(c.PSVIEW_DEFAULT,e)){var r=o.getDefaultView();if(null==r)return void w.error("No default view found.");e=r.getId()}if(/^~/.test(e)){var a=e.substring(1),s=g.findFirstViewIdOfGroupName(a);if(null==s)return o;e=s}if(!o.ifExists(e,t)){w.log("Trying to navigate to view: '{}' within namespace: '{}' with params: {}, options: {}",e,t,i.params,i.options);var l=new Error("Target view: '"+e+"' within namespace: '"+t+"' does not exist! Firing event 'viewnotexist'...");return console.error(l),o.fire("viewnotexist",{targetViewId:e,targetViewNamespace:t}),o}return i.type=o.SWITCHTYPE_VIEWCHANGE,u.replaceViewState(e,t,null,null==i?null:i.options),g.showView(e,t,i),o},o.back=function(e){return f.clearViewParameters(c.PSVIEW_BACK),null!=e&&"params"in e&&f.setViewParameters(c.PSVIEW_BACK,"",e.params),history.go(-1),o},o.forward=function(e){return f.clearViewParameters(c.PSVIEW_FORWARD),null!=e&&"params"in e&&f.setViewParameters(c.PSVIEW_FORWARD,"",e.params),history.go(1),o};var h=document.title;o.setDocumentTitle=function(e){return n.isEmptyString(e,!0)?(w.warn("Invalid document title: "+e),o):(document.title=h=e,o)},o.onceHistoryBack=function(e){if("function"!=typeof e)throw new Error("Invalid argument! Type of 'Function' is needed.");return s.pushState(n.randomString(),e),o},o.reDoLayout=function(){return g.listAllViews().forEach(function(e){n.try2Call(e.getLayoutAction())}),o};var p,v,m,y,V,S=!1,E=!1,b=function(e){var t=o.getActiveView(),i=null==t?null:t.getId(),r=null==t?null:t.getNamespace();w.log("{} Current: {}",n.env.isHistoryPushPopSupported?"State poped!":"Hash changed!",t&&t.getId()),w.log("↑ {}",n.env.isHistoryPushPopSupported?JSON.stringify(e.state):location.hash);var a,s,l,f=o.SWITCHTYPE_VIEWNAV,d=null;if(null==e.state){f=o.SWITCHTYPE_VIEWNAV;var h,p,v=c.parseViewInfoFromHash(location.hash);if(null==v?(d=t,h=i,p=r):(a=v.viewId,s=v.viewNamespace,null!=(d=g.getFinalView(a,s))&&(h=d.getId(),p=d.getNamespace())),null!=h){var m=h==a&&p==s;l=h==i&&p==r?o.currentState?o.currentState.options:null:m?v.options:null,u.replaceViewState(h,p,null,l),g.showView(d.getId(),d.getNamespace(),{type:f,options:l})}}else if(u.isConstructorOf(e.state)){var y=e.state;a=y.viewId,s=y.viewNamespace,o.ifExists(a,s)?(d=o.ofId(a,s),l=y.options):(w.warn("Popped view: '"+a+"' within namespacer: '"+s+"' does not exist, keeping current."),d=t,l=null);var h=d.getId(),p=d.getNamespace();null!=o.currentState&&(f=y.sn<o.currentState.sn?o.SWITCHTYPE_HISTORYBACK:o.SWITCHTYPE_HISTORYFORWARD),u.replaceViewState(h,p,y.sn,l),g.showView(h,p,{type:f,options:l})}else w.info("Skip state: {}",e.state)},I=function(){p(),document.documentElement.setAttribute(d.attr$view_os,n.env.isIOS?"ios":n.env.isAndroid?"android":n.env.isWindowsPhone?"wp":"unknown"),window.addEventListener(n.env.isHistoryPushPopSupported?"popstate":"hashchange",b),function(){var e=document.querySelectorAll("["+d.attr$view_container+"]");if(0===e.length)document.body.setAttribute(d.attr$view_container,"");else for(var t=1;t<e.length;t++)e[t].removeAttribute(d.attr$view_container)}();var e=g.getViewDomElements(),t=[];[].forEach.call(e,function(e){var i=e.getAttribute(d.attr$view_namespace);n.isEmptyString(i,!0)&&(i=g.defaultNamespace,e.setAttribute(d.attr$view_namespace,i));var r=g.getPotentialViewId(e),a=o.ofId(r,i);if(t.indexOf(a)!==-1)return void w.warn("Multiple view of id: '{}' within namespace: '{}' exists.",a.id,a.namespace);t.push(a),e.classList.remove("active"),e.classList.add("view"),a.on("enter",function(){var t=e.getAttribute(d.attr$view_title);document.title=null==t?h:t})});var i=null;i=function(){for(var t=null,n=-1,i=0;i<e.length;i++)if("true"===e[i].getAttribute(d.attr$view_default)){n=i;break}if(-1!==n){t=e[n];for(var i=n+1;i<e.length;i++)"true"===e[i].getAttribute(d.attr$view_default)&&e[i].removeAttribute(d.attr$view_default)}else 0!==e.length?(t=e[0],t.setAttribute(d.attr$view_default,"true")):w.warn("No view exists to determine the default view.");return t}(),null!=i&&i.classList.add("active"),function(){r.addTapListener(document.documentElement,function(e){for(var t,i=e.changedTouches?e.changedTouches[0].target:e.target,r=i;null==r.getAttribute(d.attr$view_rel)&&(r=r.parentNode,r instanceof HTMLElement||(r=null),null!=r););if(null!=r&&(t=r.getAttribute(d.attr$view_rel)),null!=t&&""!==t.trim()){if(!("true"===r.getAttribute(d.attr$view_rel_disabled))){if(e.preventDefault(),/^(http|https|ftp):\/\//gim.test(t))return void(window.location.href=t);if(/^\s*@+/.test(t)){var a=t.replace(/^\s*@+/,"").trim();return""===a?void w.warn("Empty file path for data-view-rel: '{}'",t):void(window.location.href=a)}if(n.ifStringEqualsIgnoreCase(c.PSVIEW_BACK,t))return void history.go(-1);if(n.ifStringEqualsIgnoreCase(c.PSVIEW_FORWARD,t))return void history.go(1);if(n.ifStringEqualsIgnoreCase(c.PSVIEW_DEFAULT,t)){var u=o.getDefaultView();t=null==u?null:u.getId()}var s=null;if(/^~/.test(t)){var l=t.match(/^~([^!]+)(?:!+(.*))?/);if(null==l)return;var f=l[1].trim(),h=n.parseParams(l[2]),p=g.findFirstViewIdOfGroupName(f);if(null==p)return;t=p,s=h}else{var v=c.parseViewInfoFromHash("#"+t);t=v.viewId,s=v.options}var m=r.getAttribute(d.attr$view_rel_namespace);n.isEmptyString(m,!0)&&(m=g.defaultNamespace);var y=r.getAttribute(d.attr$view_rel_type);y=n.isEmptyString(y,!0)?"nav":y,/^(?:nav)|(?:change)$/.test(y)||(w.warn("Unknown view switch type: {}. {}",y,r),y="nav"),o[y+"To"](t,m,{options:s})}}},{useCapture:!0})}(),function(){var e=document.documentElement.getAttribute(d.attr$view_whr);if(null==e||""===(e=e.trim().toLowerCase()))return void a.init();var t=/(\d+(?:\.\d*)?)\s*\/\s*(\d+(?:\.\d*)?)/i,n=e.match(t);null==n?(w.warn("Invalid view expected width height ratio: {}. Value such as '320/568'(iPhone 5) is valid. Using '{}' instead.",e,g.defaultWidthHeightRatio),n=g.defaultWidthHeightRatio.exec(t)):w.info("Using specified expected width height ratio: {}",e),a.setExpectedWidthHeightRatio(Number(n[1])/Number(n[2])).init();!function(){for(var e=document.querySelectorAll("input, select, textarea, *[contentEditable]"),t=0;t<e.length;t++)e[t].blur();a.doLayout()}()}(),w.info("Marking View as initialized and ready"),v(),m(),function(){if(null!=o.currentState)return void w.debug("Skip showing specified view.");var e=null==i?null:g.getPotentialViewId(i),t=null==i?null:i.getAttribute(d.attr$view_namespace)||g.defaultNamespace,r=c.parseViewInfoFromHash(location.hash),a=null==r?null:r.viewId,s=null==r?null:r.viewNamespace,l=null==r?null:r.options,f=null,h=null,p=n.isEmptyString(e,!0);if(!n.isEmptyString(a,!0)&&o.ifExists(a,s)?(f=a,h=s):(w.warn("No view of id: '{}' namespace: '{}'(specified in the location hash) found, trying to show the default view",a,s),!p&&o.ifExists(e,t)?(f=e,h=t):(w.warn("No default view(id: '{}', namespace: '{}') found.",e,t),f=null,h=null)),n.isEmptyString(f,!0))return void w.warn("Can not determine the initial view!");var v=g.getFinalView(f,h);if(null==v)return void w.error("No final view found for view of id: '{}', namespace: '{}'",f,h);f=v.getId(),h=v.getNamespace(),f==a&&h==s||(l=null),w.info("Showing view: '{}' within namespace: '{}'",f,h),u.replaceViewState(f,h,null,l);var m=o.getActiveView();g.switchView({srcView:m==v?null:m,targetView:v,withAnimation:!1,params:null})}()};o.beforeInit=function(){var e=[];return p=function(){for(var t=0;t<e.length;t++)n.try2Call(e[t]);e=[]},v=function(){S=!0},function(t){return S?o:(e.indexOf(t)===-1&&e.push(t),o)}}(),o.ready=function(){var e=[];return m=function(){E=!0;for(var t=0;t<e.length;t++)n.try2Call(e[t]);e=[]},function(t){return E?(n.try2Call(t),o):(e.indexOf(t)===-1&&e.push(t),o)}}(),o.setInitializer=function(e,t){if("function"==typeof e){arguments.length<2&&(t="domready");var n="domready, rightnow".split(/\s*,\s*/);n.indexOf(t)===-1&&(w.warn("Unknown initializer exec time: {}. Supported: {}",t,n),t="domready"),y=e,V=t,S||"rightnow"!==t||(w.info("Calling specified view initializer right now"),e(I))}},document.addEventListener("DOMContentLoaded",function(){null==y?(w.info("Initializing View automatically on dom ready"),I()):"domready"===V&&(w.info("Calling specified view initializer on dom ready"),y(I))}),e[t]=o}(window,"View");