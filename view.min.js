(function(o,k){var a=(function(){var af=function(){if(arguments.length==0){return}var ak=arguments;var am=" "+String(arguments[0]);var al=1;am=am.replace(/([^\\])\{\}/g,function(ao,ap){var an=(ak.length-1)<al?"{}":String(ad(ak[al]));al++;return ap+an});am=am.replace(/\\\{\}/g,"{}");return am.substring(1)};var ah=function(){var an=new Date();var ap=an.getFullYear();var ao="0"+String(an.getMonth()+1);ao=ao.substring(ao.length-2);var ak="0"+String(an.getDate());ak=ak.substring(ak.length-2);var al="0"+String(an.getHours());al=al.substring(al.length-2);var aq="0"+String(an.getMinutes());aq=aq.substring(aq.length-2);var am="0"+String(an.getSeconds());am=am.substring(am.length-2);return ao+ak+" "+al+":"+aq+":"+am};var ad=function(am){if(null==am){return null}if((typeof am=="number")||(typeof am=="string")||(typeof am=="boolean")){return am}else{if(typeof am=="function"){return"function "+am.name+"(){...}"}else{if(!(am instanceof Array)&&(typeof am=="object")){if(String(am)!="[object Object]"){return String(am)}else{try{var al={};for(var an in am){al[an]=ad(am[an])}return JSON.stringify(al)}catch(ak){return String(am)}}}else{if(am instanceof Array){return JSON.stringify(am.map(function(ao){return ad(ao)}))}else{return am}}}}};var ac=function(ak){return ah()+" ["+ak+"]: "};var ai={};var ab,ag;(function(){var ak=true;ab=function(){return ak};ag=function(al){ak=al}})();var aj=function(al){var ak=true;this.isEnabled=function(){return ab()&&ak};this.setIsEnabled=function(am){ak=am;return this};this.getName=function(){return al};this.debug=function(){if(!this.isEnabled()){return}var am=af.apply(null,arguments);console.debug(ac(al)+am)};this.info=function(){if(!this.isEnabled()){return}var am=af.apply(null,arguments);console.info(ac(al)+am)};this.warn=function(){if(!this.isEnabled()){return}var am=af.apply(null,arguments);console.warn(ac(al)+am)};this.error=function(){if(!this.isEnabled()){return}var am=af.apply(null,arguments);console.error(ac(al)+am)};this.log=function(){if(!this.isEnabled()){return}var am=af.apply(null,arguments);console.log(ac(al)+am)}};var ae=function(ak){if(ak in ai){return ai[ak]}var al=new aj(ak);ai[ak]=al;return al};aj.ofName=ae;aj.isGloballyEnabled=ab;aj.setIsGloballyEnabled=ag;return aj})();var Q=(function(){var ae="  __com.soft.plugin.touch#"+new Date().getTime()+"__  ";var ac=function(ah,ag){ah=ah||{};ag=ag||{};for(var ai in ag){if(!(ai in ah)){ah[ai]=ag[ai]}}return ah};var af=function(ah,ag){ah=ah||{};ah[ag]=ah[ag]||{};return ah[ag]};var ad=function(aj,ak,ah){if(!e){aj.addEventListener?aj.addEventListener("click",ak):aj.attachEvent("onclick",ak);return}var ai=af(aj,ae+".tap");ai.callbacks=ai.callbacks||[];if(ai.callbacks.indexOf(ak)!=-1){return}ai.callbacks.push(ak);ah=ac(ah,{timespan:500,delta:{},useCapture:false});ah.delta=ac(ah.delta,{x:10,y:15});var ag=af(aj,ae+".tap.meta");if(null==ag.touchstart){ag.touchstart=function(al){var am=al.changedTouches?al.changedTouches[0]:al;ai.startX=am.screenX;ai.startY=am.screenY;ai.startTimestamp=Date.now()};aj.addEventListener("touchstart",ag.touchstart)}if(null==ag.touchend){ag.touchend=function(an){var ap=an.changedTouches?an.changedTouches[0]:an;ai.stopX=ap.screenX;ai.stopY=ap.screenY;ai.stopTimestamp=Date.now();var ao=ai.stopTimestamp-ai.startTimestamp,am=Math.abs(ai.stopX-ai.startX),al=Math.abs(ai.stopY-ai.startY);if(ao<=ah.timespan&&am<=ah.delta.x&&al<=ah.delta.y){ai.callbacks.forEach(function(aq){aq&&aq.call(aj,an)})}};aj.addEventListener("touchend",ag.touchend,ah.useCapture)}};var ab=function(ak,al,ag){if(!e){ak.removeEventListener?ak.removeEventListener("click",al):ak.detachEvent("onclick",al);return}if(!ak.hasOwnProperty(ae)){return}var aj=af(ak,ae+".tap");var ai=aj.callbacks.indexOf(al);if(ai==-1){return}aj.callbacks.splice(ai,1);if(aj.callbacks.length==0){var ah=af(ak,ae+".tap.meta");ak.removeEventListener("touchstart",ah.touchstart);ak.removeEventListener("touchend",ah.touchend,ag);delete ak[ae].tap}};return{addTapListener:ad,removeTapListener:ab}})();var y=function(ac,ab,ae){if(arguments.length<3){ae=false}ac=ac||{};ab=ab||{};for(var ad in ab){if(!(ad in ac)||(ad in ac&&null==ac[ad]&&ae)){ac[ad]=ab[ad]}}return ac};var J=(function(){var ab=function(ac,ad){this.type=ac;this.timestamp=new Date().getTime();this.data=ad;Object.freeze&&Object.freeze(this)};return function(ad,ac){(function(ag,ae){var af={};ag.on=function(ai,ah){ai=ai.toLowerCase();af[ai]=af[ai]||[];if(af[ai].indexOf(ah)!=-1){return}af[ai].push(ah)};ag.off=function(aj,ai){aj=aj.toLowerCase();af[aj]=af[aj]||[];var ah=af[aj].indexOf(ai);if(ah==-1){return}af[aj].splice(ah,1)};ag.fire=function(ah,aj){ah=ah.toLowerCase();var ai=new ab(ah,aj);af[ah]=af[ah]||[];af[ah].forEach(function(ak){ak.call(ae,ai)})}})(ad,ac)}})();var q=function(ac,ab,ad){Object.defineProperty(ac,ab,{value:ad,configurable:false,writable:false,enumerable:true})};var D=function(ad,ab,ac){if(null==ad||typeof ad!="function"){return}try{ad.apply(ab,ac)}catch(ae){n.error("Error occured while executing function: {}. {}",ad.name,ae)
}};var h=function(ac,ab){if(arguments.length<2){ab=false}if(null===ac||undefined===ac){return true}ac=String(ac);if(ab){ac=ac.trim()}return ac.length==0};var g=/mobile|tablet|ip(ad|hone|od)|android/i,N=("ontouchstart" in window),e=g.test(navigator.userAgent);var b=new Object();var u=":back",M=":forward";var n=a.ofName("View");var X=[];var T=null;var G="data-view",d="data-view-default",p="data-view-directly-accessible",Y="data-view-fallback",U="data-view-rel",S="data-view-rel-disabled",P="data-view-rel-type",t="data-view-title";var Z=("pushState" in history)&&(typeof history.pushState=="function");n.log("History pushState is "+(Z?"":"not ")+"supported");var O=[];var j={};var K=function(ab){return u==ab||M==ab};var A=function(ab,ac,ad){if(!W.ifExists(ab)&&!K(ab)){throw new v("View of id: "+ab+" does not exist.")}if(arguments.length<3){throw new Error("Invalid argument length. Both parameter name and value should be specified.")}j[ab]=j[ab]||{};j[ab][String(ac)]=ad;return W};var x=function(ab,ac){if(!W.ifExists(ab)&&!K(ab)){throw new v("View of id: "+ab+" does not exist.")}if(undefined===ac){ac=null}if(typeof ac!="object"){throw new Error("Parameters specified should be an object or null.")}j[ab]=ac;return W};var V=function(ab){delete j[ab];return W};var l=function(ab,ad,ac){if(arguments.length<3){ac=null}if(arguments.length<2){ad=Date.now()}q(this,"viewId",ab);q(this,"timestamp",ad);q(this,"options",ac);this.toString=function(){return JSON.stringify(this)};this.clone=function(){return JSON.parse(this.toString())}};l.isConstructorOf=function(ab){if(null==ab||typeof ab!="object"){return false}return ab.hasOwnProperty("viewId")&&ab.hasOwnProperty("timestamp")};var aa=function(ab){return encodeURIComponent(String(ab)).replace(/\+/gm,"%2B")};var L=function(ac,ae){var ad="!";var ag=String(ac);var ab=null==ae?[]:Object.keys(ae);var af=ab.reduce(function(ak,aj,ai,ah){return ak+"&"+aa(aj)+"="+aa(ae[aj])},"");if(af.length>0){ag+=ad+af.substring(1)}return ag};var C=function(ab,ae,ac){if(arguments.length<3){ac=null}if(arguments.length<2){ae=Date.now()}var ad=new l(ab,ae,ac).clone();n.log("â†“ {}",JSON.stringify(ad));if(Z){history.pushState(ad,"","#"+L(ab,ac))}else{location.hash=L(ab,ac)}W.currentState=ad};var s=function(ab,ae,ac){if(arguments.length<3){ac=null}if(arguments.length<2){ae=Date.now()}var ad=new l(ab,ae,ac).clone();n.log("% {}",JSON.stringify(ad));if(Z){history.replaceState(ad,"","#"+L(ab,ac))}else{location.hash=L(ab,ac)}W.currentState=ad};var v=function v(ab){Error.call(this,ab)};v.prototype=Object.create(Error.prototype);var F=function F(ab){var ad=ab,ae=b,ac;this.getName=function(){return ad};this.getValue=function(af){if(b==ae){if(arguments.length<1){return undefined}return af}else{return ae}};this.setValue=function(af){ae=af;return this};this.getApplication=function(){return ac};this.setApplication=function(af){ac=af;return this};this.apply=function(){if(typeof ac=="function"){ac(ae)}return this};Object.freeze(this)};var w=function w(){var ab={};this.has=function(ac){return ac in ab};this.get=function(ac){var ad;if(ac in ab){ad=ab[ac]}else{ad=new F(ac);ab[ac]=ad}return ad};this.applyAll=function(){var ac=Object.values(ab);if(0!=ac.length){setTimeout(function(){ac.forEach(function(ae){try{ae.apply()}catch(ad){console.error(ad)}})},0)}};this.listAll=function(){return Object.keys(ab)}};var z=function z(){var ab={};q(this,"has",function(ac){return ac in ab});q(this,"set",function(ac,ad){ab[ac]=ad;return this});q(this,"get",function(ac){return ab[ac]});q(this,"clear",function(){ab={};return this})};var W=function(af){if(null===document.querySelector("#"+af+"["+G+"=true]")){throw new v("View of id: "+af+" does not exist(No element matching pattern: '#"+af+"["+G+"=true]' found)!")}var ad={};var ab=new z();var ae=new w();J(this,document.querySelector("#"+af));var ac=this.fire;this.fire=function(ag,ah){ad[ag]=ah;ac(ag,ah)};q(this,"logger",a.ofName("View#"+af));q(this,"config",ae);q(this,"context",ab);this.getLatestEventData=function(ag){return ad[ag]};this.getContext=function(){return ab};this.clearContext=function(){ab.clear();return this};this.getId=function(){return af};this.getDomElement=function(){return document.querySelector("#"+af)};this.find=function(ag){return this.getDomElement().querySelector(ag)};this.findAll=function(ag){return this.getDomElement().querySelectorAll(ag)};this.getParameter=function(ag){var ah=j[this.getId()];if(arguments.length<1){return ah}return null==ah?null:ah[ag]};this.isReady=function(){return O.indexOf(this.getId())!=-1};this.isActive=function(){return this.getDomElement().classList.contains("active")};this.isDefault=function(){return/true/i.test(this.getDomElement().getAttribute(d))};this.isDirectlyAccessible=function(){var ag=this.getDomElement().getAttribute(p);ag=null==ag?null:ag.toLowerCase();if(W.isDirectlyAccessible()){return"false"==ag?false:true}else{return"true"==ag?true:false}};this.getFallbackView=function(){var ag=this;var ai=[this.getId()];do{var ah=ag.getDomElement().getAttribute(Y);
if(null==ah||!W.ifExists(ah)){n.warn("View: "+ag.getId()+" is not permited to access directly, and no fallback configuration found, thus returning the default view");return W.getDefaultView()}else{ag=W.ofId(ah);if(ai.indexOf(ag.getId())!=-1){n.error("Cyclical reference of view on fallback configuration on view: {}. Chain: {}, view id: {}",this.getId(),ai,ag.getId());return W.getDefaultView()}if(ag.isDirectlyAccessible()){return ag}ai.push(ah)}}while(true)};Object.freeze&&Object.freeze(this)};W.SWITCHTYPE_HISTORYFORWARD="history.forward";W.SWITCHTYPE_HISTORYBACK="history.back";W.SWITCHTYPE_VIEWSWITCH="view.switch";W.Logger=a;W.currentState=null;J(W);W.ofId=function(ad){for(var ac=0;ac<X.length;ac++){if(X[ac].getId().trim()==ad.trim()){return X[ac]}}var ab=new W(ad);X.push(ab);return ab};W.ifExists=function(ac){for(var ab=0;ab<X.length;ab++){if(X[ab].getId().trim()==ac.trim()){return true}}return false};W.isExisting=W.ifExists;W.listAll=function(){return[].concat(X)};W.setAsDefault=function(ab){var ad=W.getDefaultView();if(null!=ad){if(ad.getId()==ab){return}ad.getDomElement().removeAttribute(d)}var ac=W.ofId(ab);var ae=ac.getDomElement();ae.setAttribute(d,"true");return W};W.isDirectlyAccessible=function(){var ab=document.documentElement.getAttribute(p);ab=null==ab?"false":ab;ab=ab.toLowerCase();return"true"==ab};W.setIsDirectlyAccessible=function(ab){document.documentElement.setAttribute(p,String(!!ab).toLowerCase());return W};W.getActiveView=function(){for(var ab=0;ab<X.length;ab++){if(X[ab].isActive()){return X[ab]}}return null};W.getDefaultView=function(){for(var ab=0;ab<X.length;ab++){if(X[ab].isDefault()){return X[ab]}}return null};W.setSwitchAnimation=function(ab){if(!(ab instanceof Function)){throw new Error("Invalid argument. Animation of Function is needed.")}T=ab;return W};W.getSwitchAnimation=function(){return T};var m=function(ag){if(""==ag){return null}var af=/^#([\w\$\-]+)(?:!+(.*))?/;var ac=ag.match(af);if(null==ac){return null}var ab=ac[1],ae=null;if(null!=ac[2]&&""!=ac[2].trim()){var ad=ac[2].split(/\s*&\s*/);if(0!=ad.length){ae={};ad.forEach(function(ai){var ah=ai.split(/\s*=\s*/);ae[decodeURIComponent(ah[0])]=decodeURIComponent(ah[1])})}}return{viewId:ac[1],options:ae}};W.getActiveViewOptions=function(){var ab=m(location.hash);return null==ab?null:ab.options};var B=function(ad){ad=y(ad,{srcView:null,targetView:null,type:W.SWITCHTYPE_VIEWSWITCH,withAnimation:true,params:null});var aj=ad.srcView,ab=ad.targetView,ah=ad.type,ae=ad.params;if(null==ah){ah=W.SWITCHTYPE_VIEWSWITCH}var ak=ah.toLowerCase()==W.SWITCHTYPE_HISTORYBACK,ai=ah.toLowerCase()==W.SWITCHTYPE_HISTORYFORWARD;if(!ak&&!ai){ah=W.SWITCHTYPE_VIEWSWITCH}W.fire("beforechange",{currentView:aj,targetView:ab,type:ah,params:ae});aj&&aj.fire("leave",{targetView:ab,type:ah});var ag=function(){aj&&aj.getDomElement().classList.remove("active");ab.getDomElement().classList.add("active")};var af=function(){var al=ab.getId();V(al);if(ak){if(u in j){x(al,j[u]);delete j[u]}}else{if(ai){if(M in j){x(al,j[M]);delete j[M]}}else{x(al,ae)}}var am={sourceView:aj,type:ah,params:ae};if(!ab.isReady()){O.push(al);ab.fire("ready",am)}["beforeenter","enter","afterenter"].forEach(function(an){ab.fire(an,am)})};var ac=function(){ag();af()};if(!ad.withAnimation){ac()}else{if(T){T.call(null,aj?aj.getDomElement():null,ab.getDomElement(),ah,ac)}else{ac()}}W.fire("afterchange",{currentView:aj,targetView:ab,type:ah,params:ae})};var E=function(ab,ad){ad=y(ad,{type:W.SWITCHTYPE_VIEWSWITCH},true);if(!W.ifExists(ab)){throw new Error("Target view: "+ab+" does not exist!")}var ae=W.getActiveView();if(ae.getId().toLowerCase()==ab.toLowerCase()){return W}n.log("{} â†’ {} {}",ae.getId(),ab,JSON.stringify(ad));var ac=W.ofId(ab);ad.srcView=ae;ad.targetView=ac;B(ad);return W};W.show=E;W.switchTo=function(ab,ad,ac,ae){if(arguments.length<4){ae=null}if(arguments.length<3){ac=true}if(arguments.length<2){ad=W.SWITCHTYPE_VIEWSWITCH}ad=ad||W.SWITCHTYPE_VIEWSWITCH;E(ab,{type:ad,withAnimation:ac,params:ae});return W};W.switchView=W.switchTo;W.navTo=function(ab,ac){ab=ab.trim();var ad=W.getActiveView();if(ad.getId().toLowerCase()==ab.toLowerCase()){return W}if(u==ab){W.back(ac);return W}if(M==ab){W.forward(ac);return W}E(ab,ac);C(ab,Date.now(),null);return W};W.updateView=W.navTo;W.changeTo=function(ab,ac){var ad=W.getActiveView();if(ad.getId().toLowerCase()==ab.toLowerCase()){return W}E(ab,ac);s(ab,Date.now(),null);return W};W.back=function(ab){V(u);if(null!=ab&&"params" in ab){x(u,ab.params)}history.go(-1)};W.forward=function(ab){V(M);if(null!=ab&&"params" in ab){x(M,ab.params)}history.go(1)};var i=document.title;var I=function(ab){if(h(ab,true)){n.warn("Invalid document title: "+ab);return W}document.title=i=ab;return W};W.setDocumentTitle=I;var c;W.ready=(function(){var ac=false;var ab=[];c=function(){ac=true;setTimeout(function(){ab.forEach(function(ad){D(ad)})},0)};return function(ad){if(ac){D(ad);return W}if(ab.indexOf(ad)!=-1){return W}ab.push(ad);return W}})();var f=function(){var ab=W.getActiveView();
if(null==ab){ab=W.getDefaultView()}return ab};var r=function(ab){var ac=null;if(h(ab,true)||!W.ifExists(ab)){ac=f()}else{ac=W.ofId(ab);if(!ac.isDirectlyAccessible()){ac=ac.getFallbackView()}}return ac};var H=function(ag){var ai=W.getActiveView();var ad=null==ai?null:ai.getId();n.log("{} Current: {}",Z?"State poped!":"Hash changed!",ai.getId());n.log("â†‘ {}",Z?JSON.stringify(ag.state):location.hash);var ak,ah=W.SWITCHTYPE_VIEWSWITCH,am,ab=null;if(null==ag.state){ah=W.SWITCHTYPE_VIEWSWITCH;var aj=m(location.hash);ak=aj.viewId;ab=r(ak);var af=ab.getId();var ac=af==ak,al=af==ad;am=al?W.currentState.options:(ac?aj.options:null);s(af,Date.now(),am)}else{var ae=ag.state;ak=ae.viewId;if(W.ifExists(ak)){ab=W.ofId(ak);am=ae.options}else{n.warn("Poped view: "+ak+" does not exist, keeping current.");ab=ai;am=null}var af=ab.getId();if(W.currentState!=null){ah=ae.timestamp<W.currentState.timestamp?W.SWITCHTYPE_HISTORYBACK:W.SWITCHTYPE_HISTORYFORWARD}s(af,ae.timestamp,am)}W.show(ab.getId(),{type:ah,options:am})};var R=function(){window.addEventListener(Z?"popstate":"hashchange",H);var ac=document.querySelectorAll("*["+G+"=true]");[].forEach.call(ac,function(ae){W.ofId(ae.id);ae.classList.remove("active");ae.classList.add("view");(function(){var ag=ae.getAttribute(t);var af=W.ofId(ae.id);af.on("enter",function(){document.title=null==ag?i:ag})})()});var ad=null;var ab=function(){var ag=null;var af=-1;for(var ae=0;ae<ac.length;ae++){if("true"==ac[ae].getAttribute(d)){af=ae;break}}if(-1!=af){ag=ac[af];for(var ae=af+1;ae<ac.length;ae++){if("true"==ac[ae].getAttribute(d)){ac[ae].removeAttribute(d)}}}else{if(0!=ac.length){ag=ac[0];ag.setAttribute(d,"true")}else{n.warn("No view exists to determine the default view.")}}return ag};ad=ab();if(null!=ad){ad.classList.add("active")}(function(){var aj=null==ad?null:ad.id;var ah=m(location.hash);var ai=null==ah?null:ah.viewId,ag=null==ah?null:ah.options;var ae=h(ai,true)?aj:ai;if(h(ae,true)){n.warn("Can not determine the initial view!");return}var af=r(ae);ae=af.getId();if(ae!=ai){ag=null}s(ae,Date.now(),ag);B({srcView:W.getActiveView(),targetView:af,withAnimation:false,params:null})})();(function(){Q.addTapListener(document.documentElement,function(ak){var aj=ak.changedTouches?ak.changedTouches[0].target:ak.target;var ae;var ai=aj;while(null==ai.getAttribute(U)){ai=ai.parentNode;if(!(ai instanceof HTMLElement)){ai=null}if(null==ai){break}}if(null!=ai){ae=ai.getAttribute(U)}if(null==ae){return}var al="true"==ai.getAttribute(S);if(al){return}ak.preventDefault();if(/^(http|https|ftp):\/\//gim.test(ae)){window.location.href=ae;return}if(u==ae.toLowerCase().trim()){history.go(-1);return}if(M==ae.toLowerCase().trim()){history.go(1);return}var ah=W.getActiveView();var af=null==ah?null:ah.getId();if(null!=af&&af==ae){return}var ag=ai.getAttribute(P);ag=h(ag,true)?"nav":ag;if(!/^(?:nav)|(?:change)$/.test(ag)){n.warn("Unknown view switch type: {}. {}",ag,ai);ag="nav"}W[ag+"To"](ae,{type:W.SWITCHTYPE_VIEWSWITCH})},{useCapture:true})})();c()};document.addEventListener("DOMContentLoaded",R);o[k]=W})(window,"View");